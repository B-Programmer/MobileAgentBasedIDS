<!DOCTYPE html>
<!-- saved from url=(0088)https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of -->
<html style="height: 100%;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject</title> 
	<link type="text/css" rel="stylesheet" href="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.171207.1">

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="Read rows and cells from an xlsx-file: quick, dirty, effective.; Author: dietmar paul schoder; Updated: 29 Jul 2014; Section: Office Development; Chapter: Enterprise Systems; Updated: 29 Jul 2014">
<meta name="Keywords" content="Vista, C#, XML, Windows, .NET, Dev, Office, Intermediate, Win7, MS-Excel, C#5, Win8, .NET4.5, VS2013,Office Development,Enterprise Systems,Free source code, tutorials">
<meta name="Author" content="dietmar paul schoder">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 



<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "headline": "C# How To Read .xlsx Excel File With 3 Lines of Code",
  "url": "https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of",
  "discussionUrl": "https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C# (C#5), XML, Windows (Vista, Win7, Win8), .NET (.NET4.5), Office (MS-Excel), VS2013, Dev",
  "commentCount": "208",
  "editor" : {
    "@type" : "Person",
    "name" : "Sean Ewington",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3873871"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  }
  "description": "Read rows and cells from an xlsx-file: quick, dirty, effective.",
  "upvoteCount": "76",
  "articleSection": "Office Development",
  "author" : [{
      "@type" : "Person",
      "name" : "dietmar paul schoder",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=5635146"
    }],
  "datePublished": "2014-07-26",
  "dateCreated": "2014-07-26",
  "dateModified": "2014-07-29",
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.94,
    "ratingCount" : 83,
    "bestRating" : 5,
    "worstRating" : 1
  },
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/9/Enterprise-Systems.aspx",
      "name" : "Enterprise Systems"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/office/",
      "name" : "Office Development"
    }
  }]
}
</script>
	<!--<base target="_top">--><base href="." target="_top">
	<script type="text/javascript" language="Javascript" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/jquery.min.js.download"></script><script type="text/javascript">//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='%2fscript%2fJS%2fjquery-2.2.4.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
function defrm () { /* thanks twitter */ document.write = ''; window.top.location = window.self.location;  setTimeout(function() { document.body.innerHTML = ''; }, 0);  window.self.onload = function(evt) { document.body.innerHTML = ''; }; }if (window.top !== window.self) {  try {  if (window.top.location.host) { /* will throw */ } else { defrm(); /* chrome */ }  } catch (ex) { defrm(); /* everyone else */ } }if (typeof(DemoUrl)!='undefined')   document.write(unescape('%3Cme')+'ta http'+'-equiv="re'+'fresh"                  con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
$(document).ready(function(){
    $('#__EVENTVALIDATION').attr('autocomplete', 'off');
});

//]]>
</script>

	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/ga.js.download"></script>


<link type="text/css" rel="stylesheet" charset="UTF-8" href="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/translateelement.css"><script type="text/javascript" charset="UTF-8" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/main.js.download"></script><script type="text/javascript" charset="UTF-8" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/element_main.js.download"></script></head>	

<body class="chrome chrome63" style="position: relative; min-height: 100%; top: 0px;">

<a class="access-link" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of#Main"><img alt="Click here to Skip to main content" src="https://codeproject.global.ssl.fastly.net/images/t.gif"></a>





<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix">

	<div id="ctl00_MemberMenu_GenInfo" class="float-left">13,308,563 members (86,132 online)</div>

	<div class="float-left">
		
	</div>

	<div class="float-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of"
				else
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of"
				document.subForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign in</a>
                    <img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/login32.png" width="16px" height="16px" style="vertical-align:middle;">
				</span>

				<div class="tooltip-flyout">
					<form name="subForm" id="subForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of" method="post" class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email"></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password"></div>
						<div class="action">
							
                                  <input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
                                  <input type="hidden" name="fld_quicksign" value="true">
                                  <script type="text/javascript">
                                  function simpleMask(str, key) {
                                      var result = ''; 
                                      for (var i = 0; i < str.length; ++i)
                                          result += String.fromCharCode(key ^ str.charCodeAt(i));
                                      return result;
                                  }
                                  function Join() {
                                      var url = 'https://www.codeproject.com/script/Membership/Modify.aspx';
document.location.href=url;
                                      return false;
                                  }
                                  $('#joinBtn').css('visibility', 'visible');
                                  </script>
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberMenu_SendPassword" class="forgot float-right" href="https://www.codeproject.com/script/Membership/SendPassword.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark">

					Sign in with <a class="oauth" title="Sign in using Github" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Linkedin" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=LinkedIn"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/linkedin.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Facebook" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Google" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Microsoft" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Christmas/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-tags="Vista, C#, XML, Windows, .NET, Dev, Office, Intermediate, Win7, MS-Excel, C#5, Win8, .NET4.5, VS2013,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=838243"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=838243"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div></div>
        </div>
    </div>

	<a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of#Main"><img alt="Click here to Skip to main content" class="access-link" src="https://codeproject.global.ssl.fastly.net/images/t.gif"></a>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="https://www.codeproject.com/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search " id="sb_tb" value="" name="q"></td><td><input type="image" src="https://codeproject.global.ssl.fastly.net/images/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="true"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout">
			<li>
				<div id="siteMap">
					<img src="https://codeproject.global.ssl.fastly.net/images/loading48.gif" alt="loading" style="margin:150px;width:100px;height:100px;">
				</div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="https://www.codeproject.com/search.aspx?sbo=kw">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="https://www.codeproject.com/search.aspx?sbo=kw?aidlst=152&amp;sa_us=True">Beginner Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="https://www.codeproject.com/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly break" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3">Article Competition</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Submit an article or tip
			</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Post your Blog
			</a></li>		<li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Ask a Question</a></li>

		
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions...</a></li>
		
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">Javascript questions</a></li>
			
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable desktop-only"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">features</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
		<li><a id="ctl00_TopNavBar_Research" class="fly" href="https://www.codeproject.com/script/ResearchLibrary/Index.aspx">Research Library</a></li>

		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/MVPWinners.aspx">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li><a id="ctl00_TopNavBar_SoapBoxLnk" class="fly" href="https://www.codeproject.com/Forums/1536756/The-Soapbox.aspx">The Soapbox</a></li>
		<li><a id="ctl00_TopNavBar_PRLnk" class="fly break" href="https://www.codeproject.com/Forums/1738007/Press-Releases.aspx">Press Releases</a></li>

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580230/Chinese.aspx">General Chinese Topics</a></li>
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable desktop-only tablet-only" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">help</a>

	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Site Map</a></li>
		<li><a id="ctl00_TopNavBar_HelpAdvertise" class="fly" href="http://developermedia.com/">Advertise with us</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutAds" class="fly" href="https://www.codeproject.com/info/AboutOurAds.aspx">About our Advertising</a></li>
		<li><a id="ctl00_TopNavBar_HelpJobs" class="fly" href="https://www.codeproject.com/info/Jobs/">Employment Opportunities</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 
	<div class="container-content">


		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/9/Enterprise-Systems.aspx">Enterprise Systems</a> » <a href="https://www.codeproject.com/KB/office/">Office Development</a> » <a href="https://www.codeproject.com/KB/office/#Microsoft+Excel">Microsoft Excel</a></div>
			</div>

            

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				

<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_801032_24" data-size="medium" data-mode="bookmark"></span><a id="ctl00_ActionLinks_PrintMd" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?display=Print">
	    <img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/print48.png" title="Print" width="24px" height="24px" style="border:0">
    </a>
			</div>
		</div>

		<table class="extended container-article-parts" cellpadding="0" cellspacing="0">
        <tbody><tr valign="top">
		<td width="117px" class="article-wing-left">

			<div id="ctl00_Nav" class="container-article-tabs">
    			

<div class="tabs">
	<div class="selected">Tip/Trick</div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=801032">Browse Code</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=801032">Stats</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=801032">Revisions (24)</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ListAlternatives.aspx?aid=801032">Alternatives</a></div>

	<div class="unselected"><a href="https://www.codeproject.com/Tips/801032/WebControls/#_comments" id="ctl00_ArticleTabs_CommentLink" class="anchorLink">Comments 
        <span id="ctl00_ArticleTabs_CmtCnt">(208)</span></a>
	</div>
</div>	


				<a id="ctl00_AddAlternative" title="Write a related article about upgrades or translate this into a different language." class="add-item" href="https://www.codeproject.com/script/Articles/SubmissionWizard.aspx?at=6&amp;apid=801032">Add your own<br>alternative version</a>

			    <div>
                    <h4>Tagged as</h4>
			        <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Vista" data-id="27">Vista</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C--hash--" data-id="81">C#</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/XML" data-id="88">XML</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET" data-id="98">.NET</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Dev" data-id="118">Dev</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Office" data-id="149">Office</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Intermediate" data-id="153">Intermediate</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Win7" data-id="311">Win7</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/MS-Excel" data-id="414">MS-Excel</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C--hash--5" data-id="1223">C#5</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Win8" data-id="1794">Win8</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET4.5" data-id="2119">.NET4.5</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VS2013" data-id="2768">VS2013</a></div></span> 

	
	
</span>


			    </div>

                <div class="stats">
                <h4>Stats</h4>
                <div id="ctl00_ArtStats"><div class="stats"><div>946.6K views</div><div>37.4K downloads</div><div>122 bookmarked</div></div></div>
                </div>

                <div class="subdue padded-top" title="Date First posted">Posted 
                    26 Jul 2014</div>

                <div title="Licence">
                    <a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                </div>

                
			</div>

		</td>
		<td>
			
			<div id="AT" class="container-article  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="tze4GYRSjBrs1RpSYvC8uvOPbw3nYuOn8cAhwwEhTdVKTHHpsZ1sLulE6fWh/GTFbn1Sh2t3a39D9NpJJfZxc7wHGSApYpTO5lZL0NGXMq8zsJEYnr+OyoctcPm4eXLSPRE1sioPUCuHx4qzjyjXzztmreQp79GSe6rs2cT5NR/p6qaULRoAPBdqHQ+yWvQEGw93pqC6kwsUwiClKjV14P628YmukOFaT+o07yLGn2vggvZoRFeJYoJhUQ9N6pQ3ZQ4bRtCeWdWZNJBnJRMWIZDzlXJMx+MJW492kAcBqlzLVkhTR+gwdHsfWcOhDgLND1qj3ApXBVnGf7eYLW8IJ9VtNJhVDV0BRLiTzr8qtF6SIeV3vY7OICu2/VMdp+lhtiEmP8RnOh233LgmH/fgO0r/9JMJluPOwKlsvKAi6W1PpK0aq4z3gXgsJM7F3Y78cqtI+YwWmGp35z2Lm6NSh6GYiNyv+yaaFDrpdCZ4so1y+zQ55lMuTFI0VWm3kjYq9l0hFpEir+iBvipb/Ire5PWBLoJ6w3DGlYWBvArtjuQblLa73yajkYN6y3MM6rQOX6uHuE0I+gQ/S4jD5qNX72HhopQUtV9bwRrtmy5SLe0sykeH464tpuU1YGHu5cjo6ZQER8YJCPbtgklkbBUdtuKhmaUttVakW9mGSUZqQc1rejZlK9bZ4qkn98+c7zoxHpLCqY/m0FiiZNNbVMJoqtpIM45QiKCSiQqq54AD9cSBR2p1FZFNPr9x7LUEIBvkehYukJesRIROgGG6huK15orvYMcqIzyQG0zepKfg5Djf5D6m016HtyRyE9WQZEC5D/vAJ6WiqYDAFYU9PfciID1sjfnlu7quiAcNdcL+ffGBnNUKlY3RTFf6sDUcKgOpH+Fzv1jLb8Oqe6jomLYvio+hT4LsQuwZgNN3O64tdnUueqbFa3AwoxyOCcfVHVikjw8eeV9s/hojS2ckeqMg8FAZsncGTCOVzmlKL7Ta3wOT8al3TQCtgCOru391Lx9fTHWVa2wnVfhm6IhVdZDJztsxVnuuT7FnYY3BMfHZTYzwpJiRrnLppM0S6x6TqZaOTVBqAKZzaTDUr9clhh5EyqJ/bo6Glrr9rULV7CNSH5IESbz+ne/fUKtV3uEdE/t82otYyaeXYBSXS+WQXxWWYVwLMNpIyOx/VEJ2k3KAspM9f703iiSj9Lbici7Pt3IjGFUFCb4MleqCcyY6Dt3vJqxW+8CaY/Bswa+EAgT0r6fQHHL9hDhNnRie78mA2Y233JKxizyvV3Plmm4ffPyc2p8b3Qla18idmxGCnjOjkl2yxclqQvUxbte+C7uViukFVQHIdOInp0sQ6vy4zFMUlCs163Fnr1wfd5MU2QGUHD7oU8gFxbyCgXFKK34j7jr3KbGBQHw5Rn+ZYux29gBIjJZ9zrPILZBwB3JOww9/uvG72ybEJe7z/maLiN5DYVkP/2mqpIi10S45nqucewRmPn60awsKBJdHEuX3wPggXkqVjH5JAwYCTKNW/3j7fhqUAGHhAbg6fkLCuIDcayBLAL+NLdzFLh4Y75eqKyesu1E9FKEQNpHY98GpjcBabinMoqeyE+6X1M6qjdTBEiqUzwlPkSnigDS2vHm/MooF1/7hkbq2DN0avwY9Tit9FUqKEBQXqtfHnjmzTmSsH1MqUlGQp2BiEMGHGeCaVe5FPLsrBBMrZL+k5zMzDzTWthy6SRQbA/5P0psiSz3MwicsgNLfkerqJuOCEgDYOGOP1USubmQ/qpV4J0PjV/0yykSuH0tb/nCys/WU5v2N8LlFt6HzBzvYFZph937vfTX7kmFHJqUMgvwka+3KZHJl1bYRWP1g9XfttQ7YlQVJlOMHXLnfvbW1Hp3q0kbVxNU7yfRiWRLclzu3o9pJjpZQYhVPKlNHwPS9OO0vXHcSVmKeHlerj55QypV06wp8bOck9/zaGaiRFtf3iVaP6+U0bO377iO/mAt5o7j2Cjazlv5APx5UDZw5Hzuxz36Zdiqd7v2c0WTphD7akVgSLN5XbGeqUYdXSkO79tL1R40WdzkTWssj/R8a5ZnUaagGT+Bk2qkPnfvizU3Oi1KjBXIY/zjH3TT9jdxQSsMWeWn0BZqoVSDJtQi1oSyuHHJKQ1NfQHD0j2MTiYRnRJZcfnoePUua9Jy9B33cK8An21MS0IE+/W/EvsW6azOFefCpMYTcjUqPch5vEaX461J+VwwbeY+mQVQFBX7oHaRYL/24Xh+D3LTxIT1q+AH/uLZfgt5TjiEAupPLKj4k+cdO96gFftJagOTdnyGx7Vw5zq1U/n7PCekUUjM=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">C# How To Read .xlsx Excel File With 3 Lines of Code</h1>
					    </div>

                        <div style="height:34px">
					        
					        <div class="entry float-left">

                                <img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/{d6c9194c-773a-4d22-b826-96824090324a}.jpg" id="ctl00_avatar" class="float-left avatar">

                                <div class="float-left">
                                    <div>
						                <span class="author"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5635146" rel="author">dietmar paul schoder</a></span>, 
						                <span class="date" title="Date last updated">
							            29 Jul 2014</span>
			                        </div>

                                    
						            <div id="ctl00_RateArticleRow" class="float-left align-right" style="margin-top:5px">

					                    <div id="ctl00_CurRat" class="tooltip anchorLink column" style="cursor:pointer;margin:2px 20px 0 0" name="CurRat_801032">
				
							                

<table id="ctl00_ArticleRating_RatingTable" cellpadding="0" cellspacing="0" class="small-text">
	<tbody><tr>
		<td class="nowrap">

		<span id="ctl00_ArticleRating_VI">
		<div class="nowrap rating-stars-medium" style="height:18px;width:80px;position:relative;">
			<div class="clipped align-left float-left" style="height:16px;width:79px;">
				<img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-fill-md.png" style="border-width:0px;">
			</div><div class="clipped" style="height:16px;width:1px;position:relative;">
				<img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-empty-md.png" style="border-width:0px;position:absolute;top:0;right:0;">
			</div>
		</div>
		</span>

		
	</td>
		<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;
		<span id="ctl00_ArticleRating_VotesR">&nbsp;4.94 (83 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_ArticleRating_RatingText"></span>


							                <div id="ctl00_RB" class="speech-bubble-container-up">
								                <div class="speech-bubble-up" style="width:150px !important">
									                            
<div>
<table class="feature" width="100%" height="50px" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0"><tbody><tr class="chart-row"><td class="chart-column"><div class="rating-ignore-vote" title="Votes not included in score."><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="3px" border="0px" alt="5 votes, 6.8%" title="5 votes, 6.8%"></div><span title="0 votes">1</span></td>
<td class="chart-column"><div class="rating-ignore-vote" title="Votes not included in score."><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="2px" border="0px" alt="3 votes, 4.1%" title="3 votes, 4.1%"></div><span title="0 votes">2</span></td>
<td class="chart-column"><div class="rating-ignore-vote" title="Votes not included in score."><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="1px" border="0px" alt="1 vote, 1.4%" title="1 vote, 1.4%"></div><span title="0 votes">3</span></td>
<td class="chart-column"><div><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="2px" border="0px" alt="4 votes, 5.4%" title="4 votes, 5.4%"></div><span title="4 votes">4</span></td>
<td class="chart-column"><div><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="50px" border="0px" alt="70 votes, 94.6%" title="70 votes, 94.6%"></div><span title="70 votes">5</span></td>
</tr></tbody></table><div class="small-text align-center">4.94/5 - 83 votes</div><div class="small-text align-center subdue">9 removed</div><div class="small-text align-center subdue">μ 4.70, σ<sub>a</sub> 1.60 [<a href="https://www.codeproject.com/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]</div>
</div>
								                </div>
								                <div class="speech-bubble-pointer-up">
									                <div class="speech-bubble-pointer-up-inner"></div>
								                </div>
							                </div>

						                </div>
                                        <div class="column">
                                        <div id="ctl00_RateArticle_RateItemWrapper" class="small-text" name="RateItem_801032">

	<table width="100%" cellpadding="0" cellspacing="0" class="small-text">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" width="16px" alt="loading..." height="16px" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/loading16.gif"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				<td id="ctl00_RateArticle_RateText" class="rating-prompt">
					Rate this:
				</td>

				
				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap rating-stars-voter-medium">
					

					<span id="ctl00_RateArticle_RB" class="tooltip ajaxHist radio voting">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5"></span> 

						
					</span>

				</td>

				
				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button">
				</td>
			</tr>
			</tbody></table>
			
		</td>
	</tr>
	</tbody></table>
	<div class="hover-container">
		
        <div id="ctl00_RateArticle_RSU" class="rating-comment align-left float-right">
            <div class="padded">
            Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign up or sign in</a> to vote.
            </div>
        </div>
	</div>
</div>
                                        </div>
                                    
                                    </div>
    						        	

                                </div>

    	                        	
                                <div class="float-left" style="margin: 25px 0 0 10px;">
	                                
	                            </div>
                         	    	
    
					        </div>

                            

						    

                        </div>

                        <div id="ctl00_description" class="summary">Read rows and cells from an xlsx-file: quick, dirty, effective.</div><span id="ctl00_thumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/tip100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
	<li><a href="https://www.codeproject.com/KB/office/801032/ExcelDLL.zip">Download ExcelDLL.zip - 6 KB</a></li>	<li><a href="https://www.codeproject.com/KB/office/801032/Excel.zip">Download Excel.zip - 12.3 KB</a></li></ul>

<h2>Introduction</h2>

<p>Our customers often have to import data from very simple Excel *.xslx-files into our software product: with some relevant rows and cells in rather primitive worksheets of an Excel&nbsp;workbook, and that's it. But we do not want to use large DLL's or third party software for that. Therefore we produced a small solution for our needs. It could be useful for you, too:&nbsp;</p>

<h2>Using the code</h2>

<p>Download the "Excel.dll" (12 kByte, you need .net 4.5!) and add it as a reference to your project. Or adapt the compact source code before - with only the relevant classes "<code>Workbook</code>", "<code>Worksheet</code>", "<code>Row</code>" and "<code>Cell</code>" and 45 C# code lines doing important work in total. Then read the worksheets, rows and cells from any Excel *.xlsx-file in your program like so:</p>

<pre lang="cs"><span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> worksheet <span class="code-keyword">in</span> Workbook.Worksheets(<span class="code-string">@"</span><span class="code-string">C:\ExcelFile.xlsx"</span>)
    <span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> row <span class="code-keyword">in</span> worksheet.Rows)
        <span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> cell <span class="code-keyword">in</span> row.Cells)
            <span class="code-comment">//</span><span class="code-comment"> if (cell != null) // Do something with the cells</span></pre>

<p>Here you iterate through the worksheets, the rows (and the cells of each row) of the Excel file within three lines of code.</p>

<h2>Points of Interest</h2>

<p>This <a href="http://www.codeproject.com/Articles/208075/How-to-read-and-write-xlsx-Excel-file-Part-I">article</a> (written by&nbsp;<a href="http://www.codeproject.com/script/Membership/View.aspx?mid=7959107">M I developer</a>) describes all the theoretical background, if you are interested in it. We based our solution on the integrated ZIP-library in .net 4.5 and the standard XML-serializer of .net.</p>

<p>If you want to adapt our solution to your needs:&nbsp;edit the simple source code for&nbsp;the Excel.dll. This is how it works:</p>

<p>Maybe you did not know that&nbsp;xlsx-files are ZIP-files. And the text strings of the Excel cells of all worksheets per workbook are always stored in a file named "<code>xl/sharedStrings.xml</code>", while the worksheets are called "<code>xl/worksheets/sheet[1...n].xml</code>".</p>

<p>So we have to unzip and deserialize the relevant XML files in the Excel xlsx-file:</p>

<pre lang="cs"><span class="code-keyword">using</span> System.IO.Compression;

<span class="code-keyword">public</span> <span class="code-keyword">static</span> IEnumerable&lt;worksheet&gt; Worksheets(<span class="code-keyword">string</span> ExcelFileName)
{
    worksheet ws;

    <span class="code-keyword">using</span> (ZipArchive zipArchive = ZipFile.Open(ExcelFileName, ZipArchiveMode.Read))
    {
        SharedStrings = DeserializedZipEntry&lt;sst&gt;(GetZipArchiveEntry(zipArchive, <span class="code-string">@"</span><span class="code-string">xl/sharedStrings.xml"</span>));
        <span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> worksheetEntry <span class="code-keyword">in</span> (WorkSheetFileNames(zipArchive)).OrderBy(x =<span class="code-keyword">&gt;</span> x.FullName))
        {
            ws = DeserializedZipEntry&lt;worksheet&gt;(worksheetEntry);
            ws.ExpandRows();
            <span class="code-keyword">yield</span> <span class="code-keyword">return</span> ws;
        }
    }
}</pre>

<p>As you see, we also have to find all worksheets of the workbook at the beginning. We filter the ZIP-archive entries for that:</p>

<pre lang="cs"><span class="code-keyword">private</span> <span class="code-keyword">static</span> IEnumerable&lt;ziparchiveentry&gt; WorkSheetFileNames(ZipArchive ZipArchive)
{
    <span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> zipEntry <span class="code-keyword">in</span> ZipArchive.Entries)
        <span class="code-keyword">if</span> (zipEntry.FullName.StartsWith(<span class="code-string">"</span><span class="code-string">xl/worksheets/sheet"</span>))
            <span class="code-keyword">yield</span> <span class="code-keyword">return</span> zipEntry;
}</pre>

<p>For deserialization of&nbsp;each XML formatted&nbsp;ZIP-entry (see also this <a href="http://www.codeproject.com/Articles/347758/XML-Serialization-and-Deserialization">article</a> written by <a href="http://www.codeproject.com/script/Membership/View.aspx?mid=4865747">Md. Rashim uddin</a>) we use this generic method:</p>

<pre lang="cs"><span class="code-keyword">private</span> <span class="code-keyword">static</span> T DeserializedZipEntry&lt;T&gt;(ZipArchiveEntry ZipArchiveEntry)
{
    <span class="code-keyword">using</span> (Stream stream = ZipArchiveEntry.Open())
        <span class="code-keyword">return</span> (T)<span class="code-keyword">new</span> XmlSerializer(<span class="code-keyword">typeof</span>(T)).Deserialize(XmlReader.Create(stream));
}</pre>

<p>Therefore the&nbsp;XML-structures have to be reflected in our classes. Here you see the "<code>sst</code>"-class and the "<code>SharedString</code>"-class for the XML in the "<a href="http://msdn.microsoft.com/en-us/library/office/gg278316(v=office.15).aspx">shared strings&nbsp;table</a>":</p>

<pre lang="xml" data-lang-guess="XML"><span class="code-summarycomment">&lt;?</span><span class="code-summarycomment">xml</span><span class="code-summarycomment"> </span><span class="code-summarycomment">version</span><span class="code-keyword">="</span><span class="code-keyword">1.0"</span><span class="code-summarycomment"> </span><span class="code-summarycomment">encoding</span><span class="code-keyword">="</span><span class="code-keyword">UTF-8"</span><span class="code-summarycomment"> </span><span class="code-summarycomment">standalone</span><span class="code-keyword">="</span><span class="code-keyword">yes"</span><span class="code-summarycomment">?</span><span class="code-summarycomment">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">sst</span><span class="code-attribute"> </span><span class="code-attribute">xmlns</span><span class="code-keyword">="</span><span class="code-keyword">http://schemas.openxmlformats.org/spreadsheetml/2006/main"</span><span class="code-attribute"> </span><span class="code-attribute">count</span><span class="code-keyword">="</span><span class="code-keyword">72"</span><span class="code-attribute"> </span><span class="code-attribute">uniqueCount</span><span class="code-keyword">="</span><span class="code-keyword">6"</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">si</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">t</span><span class="code-keyword">&gt;</span>Text A<span class="code-keyword">&lt;</span><span class="code-leadattribute">/t</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">/si</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">si</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">t</span><span class="code-keyword">&gt;</span>Text B<span class="code-keyword">&lt;</span><span class="code-leadattribute">/t</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">/si</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/sst</span><span class="code-keyword">&gt;</span></pre>

<pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> sst
{
    [XmlElement(<span class="code-string">"</span><span class="code-string">si"</span>)]
    <span class="code-keyword">public</span> SharedString[] si;

    <span class="code-keyword">public</span> sst()
    {
    }
}

<span class="code-keyword">public</span> <span class="code-keyword">class</span> SharedString
{
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> t;
}</pre>

<p>The same strategy we also use for the "<a href="http://msdn.microsoft.com/en-us/library/office/gg278309(v=office.15).aspx">worksheet</a>" -XML-file in the ZIP-file. There we focus on the XML-elements and -attributes "<code>row</code>", "<code>c</code>", "<code>v</code>", "<code>r</code>" and "<code>t</code>". All the work is done again by the <code>XmlSerializer</code>:</p>

<pre lang="xml" data-lang-guess="XML"><span class="code-summarycomment">&lt;?</span><span class="code-summarycomment">xml</span><span class="code-summarycomment"> </span><span class="code-summarycomment">version</span><span class="code-keyword">="</span><span class="code-keyword">1.0"</span><span class="code-summarycomment"> </span><span class="code-summarycomment">encoding</span><span class="code-keyword">="</span><span class="code-keyword">UTF-8"</span><span class="code-summarycomment"> </span><span class="code-summarycomment">standalone</span><span class="code-keyword">="</span><span class="code-keyword">yes"</span><span class="code-summarycomment">?</span><span class="code-summarycomment">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">worksheet</span><span class="code-attribute"> </span><span class="code-attribute">xmlns</span><span class="code-keyword">="</span><span class="code-keyword">http://schemas.openxmlformats.org/spreadsheetml/2006/main"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">dimension</span><span class="code-attribute"> </span><span class="code-attribute">ref</span><span class="code-keyword">="</span><span class="code-keyword">A1:F12"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">sheetViews</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">sheetView</span><span class="code-attribute"> </span><span class="code-attribute">workbookViewId</span><span class="code-keyword">="</span><span class="code-keyword">0"</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-leadattribute">/sheetView</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/sheetViews</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">sheetFormatPr</span><span class="code-attribute"> </span><span class="code-attribute">baseColWidth</span><span class="code-keyword">="</span><span class="code-keyword">10"</span><span class="code-attribute"> </span><span class="code-attribute">defaultRowHeight</span><span class="code-keyword">="</span><span class="code-keyword">15"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">sheetData</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">row</span><span class="code-attribute"> </span><span class="code-attribute">r</span><span class="code-keyword">="</span><span class="code-keyword">1"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">c</span><span class="code-attribute"> </span><span class="code-attribute">r</span><span class="code-keyword">="</span><span class="code-keyword">A1"</span><span class="code-attribute"> </span><span class="code-attribute">t</span><span class="code-keyword">="</span><span class="code-keyword">s"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">v</span><span class="code-keyword">&gt;</span>0<span class="code-keyword">&lt;</span><span class="code-leadattribute">/v</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/c</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">c</span><span class="code-attribute"> </span><span class="code-attribute">r</span><span class="code-keyword">="</span><span class="code-keyword">B1"</span><span class="code-attribute"> </span><span class="code-attribute">t</span><span class="code-keyword">="</span><span class="code-keyword">s"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">v</span><span class="code-keyword">&gt;</span>1<span class="code-keyword">&lt;</span><span class="code-leadattribute">/v</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/c</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">c</span><span class="code-attribute"> </span><span class="code-attribute">r</span><span class="code-keyword">="</span><span class="code-keyword">C1"</span><span class="code-attribute"> </span><span class="code-attribute">t</span><span class="code-keyword">="</span><span class="code-keyword">s"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">v</span><span class="code-keyword">&gt;</span>2<span class="code-keyword">&lt;</span><span class="code-leadattribute">/v</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/c</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">/row</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/sheetData</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/worksheet</span><span class="code-keyword">&gt;</span></pre>

<pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> worksheet
{
    [XmlArray(<span class="code-string">"</span><span class="code-string">sheetData"</span>)]
    [XmlArrayItem(<span class="code-string">"</span><span class="code-string">row"</span>)]
    <span class="code-keyword">public</span> Row[] Rows;

    <span class="code-keyword">public</span> <span class="code-keyword">class</span> worksheet
    {
    }
}
<span class="code-keyword">public</span> <span class="code-keyword">class</span> Row
{
    [XmlElement(<span class="code-string">"</span><span class="code-string">c"</span>)]
    <span class="code-keyword">public</span> Cell[] FilledCells;
}
<span class="code-keyword">public</span> <span class="code-keyword">class</span> Cell
{
    [XmlAttribute(<span class="code-string">"</span><span class="code-string">r"</span>)]
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> CellReference;
    [XmlAttribute(<span class="code-string">"</span><span class="code-string">t"</span>)]
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> tType = <span class="code-string">"</span><span class="code-string">"</span>;
    [XmlElement(<span class="code-string">"</span><span class="code-string">v"</span>)]
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> Value;
}</pre>

<p>Of course we have to do a little bit in order to convert the usual Excel cell references like "<code>A1</code>", "<code>B1</code>" and so on to column indices. That is done via&nbsp;the setter of "<code>CellReference</code>"&nbsp;in the "<code>Cell</code>"-class (here we also derive the maximum column index for the whole worksheet) ...</p>

<pre lang="cs"><span class="code-bracket">[</span><span class="code-sdkkeyword">XmlAttribute(<span class="code-string">"</span><span class="code-string">r"</span>)<span class="code-none">]</span></span>
<span class="code-keyword">public</span> <span class="code-keyword">string</span> CellReference
{
    <span class="code-keyword">get</span>
    {
        <span class="code-keyword">return</span> ColumnIndex.ToString();
    }
    <span class="code-keyword">set</span>
    {
        ColumnIndex = worksheet.GetColumnIndex(<span class="code-sdkkeyword">value</span>);
        <span class="code-keyword">if</span> (ColumnIndex <span class="code-keyword">&gt;</span> worksheet.MaxColumnIndex)
            worksheet.MaxColumnIndex = ColumnIndex;
    }
}</pre>

<p>... and a small method named "<code>GetColumnIndex()</code>":</p>

<pre lang="cs"><span class="code-keyword">private</span> <span class="code-keyword">int</span> GetColumnIndex(<span class="code-keyword">string</span> CellReference)
{
    <span class="code-keyword">string</span> colLetter = <span class="code-keyword">new</span> Regex(<span class="code-string">"</span><span class="code-string">[A-Za-z]+"</span>).Match(CellReference).Value.ToUpper();
    <span class="code-keyword">int</span> colIndex = <span class="code-digit">0</span>;

    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> colLetter.Length; i++)
    {
        colIndex *= <span class="code-digit">26</span>;
        colIndex += (colLetter[i] - <span class="code-string">'</span><span class="code-string">A'</span> + <span class="code-digit">1</span>);
    }
    <span class="code-keyword">return</span> colIndex - <span class="code-digit">1</span>;
}</pre>

<p>The last challenge has to do with the fact, that the Excel file does not contain empty Excel cells. So the tiny methods "<code>ExpandRows()</code>" and "<code>ExpandCells()</code>" handle that problem:</p>

<pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">void</span> ExpandRows()
{
    <span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> row <span class="code-keyword">in</span> Rows)
        row.ExpandCells(NumberOfColumns);
}

<span class="code-keyword">public</span> <span class="code-keyword">void</span> ExpandCells(<span class="code-keyword">int</span> NumberOfColumns)
{
    Cells = <span class="code-keyword">new</span> Cell[NumberOfColumns];
    <span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> cell <span class="code-keyword">in</span> FilledCells)
        Cells[cell.ColumnIndex] = cell;
    FilledCells = <span class="code-keyword">null</span>;
}</pre>

<p>In the end we have an array of all rows and an array of all cells for each row representing all columns of the specific Excel worksheet. Empty cells are null in the array, but the <code>ColumnIndex</code> of each cell in "<code>Row.Cells[]</code>" corresponds with the actual Excel column of each cell.</p>

<p>Unfortunately the XML format is not very clear about how to interpret the value of the Excel cells. We tried to do it like so, but any hint for improvement&nbsp;would be&nbsp;appreciated:</p>

<pre lang="cs"><span class="code-keyword">if</span> (tType.Equals(<span class="code-string">"</span><span class="code-string">s"</span>))
{
    Text = Workbook.SharedStrings.si[Convert.ToInt32(_value)].t;
    <span class="code-keyword">return</span>;
}
<span class="code-keyword">if</span> (tType.Equals(<span class="code-string">"</span><span class="code-string">str"</span>))
{
    Text = _value;
    <span class="code-keyword">return</span>;
}
<span class="code-keyword">try</span>
{
    Amount = Convert.ToDouble(_value, CultureInfo.InvariantCulture);
    Text = Amount.ToString(<span class="code-string">"</span><span class="code-string">#,##0.##"</span>);
    IsAmount = <span class="code-keyword">true</span>;
}
<span class="code-keyword">catch</span> (Exception ex)
{
    Amount = <span class="code-digit">0</span>;
    Text = <span class="code-sdkkeyword">String</span>.Format(<span class="code-string">"</span><span class="code-string">Cell Value '{0}': {1}"</span>, _value, ex.Message);
}</pre>

<p>Besides, when you know that an Excel&nbsp;cell contains a date as its value, you can use this method for conversion:</p>

<pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">static</span> DateTime DateFromExcelFormat(<span class="code-keyword">string</span> ExcelCellValue)
{
    <span class="code-keyword">return</span> DateTime.FromOADate(Convert.ToDouble(ExcelCellValue));
}</pre>

<p>Let me know how&nbsp;the total Excel.DLL works in your environment&nbsp;- and have fun with it!</p>

<h2>History</h2>

<p>26.7.2014 - Posted initially.</p>

<p>26.7.2014 - Files uploaded here.</p>

<p>26.7.2014 - Explanations added, formatting improved.</p>

<p>28.7.2014 - More explanation added. Deserialization slightly improved.</p>

<p>29.7.2014 - Date conversion from Excel format to DateTime via DateTime.FromOADate()</p>

<p>29.7.2014 - Essence of class "worksheet" added.</p>

<p>31.7.2014 - Comments added in the source code, XML-documentation added to the dll</p>

<p>31.7.2014 - The program now reads all worksheets from a workbook, not only the first one</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-loadonview="true" data-tags="Vista, C#, XML, Windows, .NET, Dev, Office, Intermediate, Win7, MS-Excel, C#5, Win8, .NET4.5, VS2013,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=300x250&amp;c=838243"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=300x250&amp;c=838243"  width="300px" height="250px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

<ul class="rrssb-buttons clearfix">
    
    <li id="ctl00_SocialLike_Twitter" class="twitter">
        <!-- Replace href with your Meta and URL information  -->
        <a href="http://twitter.com/home?status=C%23+How+To+Read+.xlsx+Excel+File+With+3+Lines+of+Code+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                    c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                    C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                    C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                    c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                    C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                </svg>
            </span>
            <span class="text">twitter</span>
        </a>
    </li>

    <li id="ctl00_SocialLike_Facebook" class="facebook">
        <!-- Replace with your URL. For best results, make sure you page has the proper FB Open Graph tags in header: 
        https://developers.facebook.com/docs/opengraph/howtos/maximizing-distribution-media-content/ -->
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                        c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                        c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                </svg>
            </span>
            <span class="text">facebook</span>
        </a>
    </li>

    

    <li id="ctl00_SocialLike_LinkedIn" class="linkedin">
        <!-- Replace href with your meta and URL information -->
        <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of&amp;title=C%23+How+To+Read+.xlsx+Excel+File+With+3+Lines+of+Code+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                        c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                        h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                        c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                        C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                </svg>
            </span>
            <span class="text">linkedin</span>
        </a>
    </li>
    <li id="ctl00_SocialLike_Reddit" class="reddit">
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of&amp;title=C%23+How+To+Read+.xlsx+Excel+File+With+3+Lines+of+Code+-+CodeProject">
            <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
            </span>
            <span class="text">reddit</span>
        </a>
    </li>
    <li id="ctl00_SocialLike_GooglePlus" class="googleplus">
        <!-- Replace href with your meta and URL information.  -->
        <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.codeproject.com%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <g>
                        <g>
                            <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663
                                c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027
                                C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068
                                c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562
                                c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41
                                c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511
                                c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478
                                c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492
                                c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479
                                c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"></path>
                            <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004
                                23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89      "></polygon>
                        </g>
                    </g>
                </svg>
            </span>
            <span class="text">google+</span>
        </a>
    </li>

    

    

</ul>
<!-- Buttons end here -->

				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/{d6c9194c-773a-4d22-b826-96824090324a}.jpg" style="border-width:0px;transform:rotate(1deg);">

    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Dietmar-Schoder">dietmar paul schoder</a></b>

        <table class="extended">
        <tbody><tr>
            <td rowspan="2" nowrap="" valign="middle">
            
            </td>
            <td width="100%">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Architect</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany">http://www.wbstool.co.uk</span>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">United Kingdom <img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/GB.gif" alt="United Kingdom" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        I am a developer and convinced user of Visual Studio, C#, .net, WPF, MVVM, the project management standards of PMI and IPMA - and  Microsoft Surface. I live in Eastbourne, United Kingdom.

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-loadonview="true" data-tags="Vista, C#, XML, Windows, .NET, Dev, Office, Intermediate, Win7, MS-Excel, C#5, Win8, .NET4.5, VS2013,rating4.5,pos_bottom"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=838243"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=838243"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				</div>
				

                
        <h2 id="ctl00_AlsoRead_RelatedResults_ctl00_Header" class="also-read">You may also be interested in...</h2>
        <table class="spaced content-list also-read">
    
	    <tbody><tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl01_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl01_Thumbnail" href="https://www.codeproject.com/ResearchLibrary/263/The-Offine-First-Approach-to-Mobile-App-Developmen"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/LibraryItemThumbnail_263_100x130.png" alt="" style="border-width:0px;"></a>
            <div class="pro-badge">Pro</div></div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl01_Link" href="https://www.codeproject.com/ResearchLibrary/263/The-Offine-First-Approach-to-Mobile-App-Developmen">The Offine-First Approach to Mobile App Development</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl02_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl02_Thumbnail" href="https://www.codeproject.com/ResearchLibrary/265/Using-PDFs-to-Manage-and-Share-Content"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/LibraryItemThumbnail_265_100x130.png" alt="" style="border-width:0px;"></a>
            <div class="pro-badge">Pro</div></div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl02_Link" href="https://www.codeproject.com/ResearchLibrary/265/Using-PDFs-to-Manage-and-Share-Content">Using PDFs to Manage and Share Content</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl03_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl03_Thumbnail" href="https://www.codeproject.com/Articles/208075/How-to-read-and-write-xlsx-Excel-file-Part-I"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/Thumb-208075.JPG" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl03_Link" href="https://www.codeproject.com/Articles/208075/How-to-read-and-write-xlsx-Excel-file-Part-I">How to Read and Write .xlsx (Excel 2007) file - Part I</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl04_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl04_Thumbnail" href="https://www.codeproject.com/Articles/1220630/Building-web-based-points-of-sale-for-Android-iO"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/article100x80.png" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl04_Link" href="https://www.codeproject.com/Articles/1220630/Building-web-based-points-of-sale-for-Android-iO">Building web-based points of sale for Android &amp; iOS</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl05_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl05_Thumbnail" href="https://www.codeproject.com/Articles/210014/How-to-read-and-write-xlsx-Excel-file-Part-II"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/Thumb-210014.jpg" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl05_Link" href="https://www.codeproject.com/Articles/210014/How-to-read-and-write-xlsx-Excel-file-Part-II">How to Read and Write .xlsx (Excel 2007) File - Part II</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl06_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl06_Thumbnail" href="https://www.codeproject.com/Articles/1221186/Getting-Started-Guide-for-the-Intel-Speech-Enablin"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/article100x80.png" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl06_Link" href="https://www.codeproject.com/Articles/1221186/Getting-Started-Guide-for-the-Intel-Speech-Enablin">Getting Started Guide for the Intel® Speech Enabling Developer Kit</a></div>
                
            </div>
        </td>
	    </tr>
	
		</tbody></table>
	



				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumControl4498647.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of%3ffid%3d1864959%26df%3d90%26mpp%3d25%26prof%3dTrue%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="https://www.codeproject.com/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1864959"><input type="hidden" name="sbo" value="fm"><input id="search_forumControl4498647" type="search" class="search" name="qf"><input type="image" src="https://codeproject.global.ssl.fastly.net/images/search.gif">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="https://www.codeproject.com/script/Forums/SetOptions.aspx?fid=1864959&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;floc=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1864959"><input type="hidden" name="currentQS" value="fid=1864959&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;floc=%2fTips%2f801032%2fCsharp-How-To-Read-xlsx-Excel-File-With-Lines-of"><input type="hidden" name="floc" value="/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Spacing<select size="1" class="dropdown" name="spc">
<option selected="" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option value="Normal">Normal</option><option value="Topic">Open Topics</option><option selected="" value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;fr=26#xx0xx">Next</a></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tbody><tr id="F5467246_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5467246xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Null reference error: a solution<div class="mobile-only">
	<span class="author">OriginalGriff</span><span class="date">16-Dec-17  0:45</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-protector-16.png" title="protector" alt="protector" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6122202">OriginalGriff</a></span></td><td class="date"><span>16-Dec-17  0:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6122202" msgid="5467246" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I had the same problem: it seems to be that some files contain "odd" xml data, which means that FilledCells does not get set.<br>
I didn't chase it down, but a simple fix was:<br>
<br>
Download the source code (second link)<br>
Edit the "rows.cs" file.<br>
Change the "ExpandCells" method to allow for it:<br>
<pre><span class="code-keyword">public</span> <span class="code-keyword">void</span> ExpandCells(<span class="code-keyword">int</span> NumberOfColumns)
{
    Cells = <span class="code-keyword">new</span> Cell[NumberOfColumns];
    <span class="code-keyword">if</span> (FilledCells == <span class="code-keyword">null</span>) <span class="code-keyword">return</span>;     <span class="code-comment">//</span><span class="code-comment"> Add this line</span>
    <span class="code-keyword">foreach</span> (<span class="code-keyword">var</span> cell <span class="code-keyword">in</span> FilledCells)
        Cells[cell.ColumnIndex] = cell;
    FilledCells = <span class="code-keyword">null</span>;
}
</pre>It then works with my files, and may do for yours.<br>
<div class="signature"><small>Bad command or file name. Bad, bad command! Sit! Stay! Staaaay...</small><br>
<small>AntiTwitter: <a href="https://www.codeproject.com/Members/DalekDave">@DalekDave</a> is now a follower!</small></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5467246" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5467246/Null-reference-error-a-solution.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5467246" data-ref="3_5467246" class="rating-label" name="RateItem_5467246" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5444316_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5444316xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_bug.gif" alt="Bug" title="Bug"></td><td class="subject hover-container">Exception with the given xlsx<div class="mobile-only">
	<span class="author">ndruha</span><span class="date">13-Oct-17  5:58</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5924466">ndruha</a></span></td><td class="date"><span>13-Oct-17  5:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5924466" msgid="5444316" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi. Thank you for your work. Unfortunately it doen't work with some of the xlsx files. See the one where it fails here:<br>
<a href="https://drive.google.com/file/d/0B-bWsBNuaYf0ZVNTb1ptdGt3UXM/view?usp=sharing">generic.xlsx - Google Drive</a>[<a href="https://drive.google.com/file/d/0B-bWsBNuaYf0ZVNTb1ptdGt3UXM/view?usp=sharing" target="_blank" title="New Window">^</a>]<br>
<br>
The exception happens when trying to enumerate the sheets or just access the first sheet:<br>
<pre>IEnumerable&lt;worksheet&gt; sheets = Workbook.Worksheets(fileName);
           <span class="code-keyword">var</span> sheet = sheets.First();
</pre><br>
<br>
<pre>System.NullReferenceException: <span class="code-sdkkeyword">Object</span> reference not <span class="code-keyword">set</span> to an instance of an <span class="code-keyword">object</span>
  at Excel.Row.ExpandCells (System.<span class="code-sdkkeyword">Int32</span> NumberOfColumns) [0x0002d] <span class="code-keyword">in</span> &lt;d6ec7237f753496cbadf28efb7f11940&gt;:<span class="code-digit">0</span> 
  at Excel.worksheet.ExpandRows () [0x0000f] <span class="code-keyword">in</span> &lt;d6ec7237f753496cbadf28efb7f11940&gt;:<span class="code-digit">0</span> 
  at Excel.Workbook+&lt;Worksheets&gt;d__2.MoveNext () [0x000c6] <span class="code-keyword">in</span> &lt;d6ec7237f753496cbadf28efb7f11940&gt;:<span class="code-digit">0</span> 
  at System.Linq.Enumerable+&lt;SelectManyIterator&gt;c__Iterator5`3[TSource,TCollection,TResult].MoveNext () [0x000fd] <span class="code-keyword">in</span> &lt;63992662b765477a898ef49cdcc99ee2&gt;:<span class="code-digit">0</span> 
  at System.Linq.Enumerable+WhereEnumerableIterator`1[TSource].MoveNext () [0x00062] <span class="code-keyword">in</span> &lt;63992662b765477a898ef49cdcc99ee2&gt;:<span class="code-digit">0</span> 
  at System.Linq.Buffer`1[TElement]..ctor (System.Collections.Generic.IEnumerable`1[T] source) [0x00087] <span class="code-keyword">in</span> &lt;63992662b765477a898ef49cdcc99ee2&gt;:<span class="code-digit">0</span> 
  at System.Linq.Enumerable.ToArray[TSource] (System.Collections.Generic.IEnumerable`1[T] source) [0x00011] <span class="code-keyword">in</span> &lt;63992662b765477a898ef49cdcc99ee2&gt;:<span class="code-digit">0</span> </pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5444316" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5444316/Exception-with-the-given-xlsx.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5444316" data-ref="3_5444316" class="rating-label" name="RateItem_5444316" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5467247_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5467247xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5467247" parent="5444316" thread="5444316" href="https://www.codeproject.com/Messages/5467247/Re-Exception-with-the-given-xlsx.aspx">Re: Exception with the given xlsx</a><div class="mobile-only">
	<span class="author">OriginalGriff</span><span class="date">16-Dec-17  0:45</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-protector-16.png" title="protector" alt="protector" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6122202">OriginalGriff</a></span></td><td class="date"><span>16-Dec-17  0:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="6122202" msgid="5467247" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5444316);" href="https://www.codeproject.com/Messages/5444316/Exception-with-the-given-xlsx.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Try the solution in my post above.<br>
<div class="signature"><small>Bad command or file name. Bad, bad command! Sit! Stay! Staaaay...</small><br>
<small>AntiTwitter: <a href="https://www.codeproject.com/Members/DalekDave">@DalekDave</a> is now a follower!</small></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5444316" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5467247/Re-Exception-with-the-given-xlsx.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5467247" data-ref="3_5467247" class="rating-label" name="RateItem_5467247" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5439921_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5439921xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Didnt work on Loadrunner<div class="mobile-only">
	<span class="author">Member 11428433</span><span class="date">29-Sep-17  14:19</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11428433">Member 11428433</a></span></td><td class="date"><span>29-Sep-17  14:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="11428433" msgid="5439921" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I have .net 4.5 installed<br>
included the dll in my reference list, but when I compiled I get a message saying<br>
Workbook does not exist in the current context. This was compiled using Loadrunner. It seems like the dll was not recognized.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5439921" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5439921/Didnt-work-on-Loadrunner.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5439921" data-ref="3_5439921" class="rating-label" name="RateItem_5439921" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5433718_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5433718xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Names of worksheets<div class="mobile-only">
	<span class="author">NikolaB</span><span class="date">11-Sep-17  7:35</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2319350">NikolaB</a></span></td><td class="date"><span>11-Sep-17  7:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2319350" msgid="5433718" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Nice library <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)"> .<br>
How can i access the names of worksheets?<br>
Thank you very much!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5433718" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5433718/Names-of-worksheets.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5433718" data-ref="3_5433718" class="rating-label" name="RateItem_5433718" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5386289_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5386289xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_kudos.gif" alt="Praise" title="Praise"></td><td class="subject hover-container">nice code<div class="mobile-only">
	<span class="author">Andres A. Avila</span><span class="date">17-Apr-17  19:44</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=13133417">Andres A. Avila</a></span></td><td class="date"><span>17-Apr-17  19:44&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="13133417" msgid="5386289" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I was looking exactly for this solution! In my company I have internal xlsx files that I need to upload to a database. And this is the best solution I found. <br>
Really I didn't understand some of the posts I read (I'm new to CodeProject), because the solution is perfectly fine for so many environments, and if it does not apply to specific ones - adapt it or discard it. Thanks in advance Dietmar.  <img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/smiley_smile.gif" align="top" alt="Smile | :)"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5386289" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5386289/nice-code.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5386289" data-ref="3_5386289" class="rating-label" name="RateItem_5386289" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5383263_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5383263xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">xlsx-File in use after reading cells in C#?<div class="mobile-only">
	<span class="author">Member 13021147</span><span class="date">10-Apr-17  5:45</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=13021147">Member 13021147</a></span></td><td class="date"><span>10-Apr-17  5:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="13021147" msgid="5383263" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi Dietmar,<br>
I have used your excel.dll and it works great!<br>
There is only one problem I have. after I have read some Cell-values in my programm, and even closing my program, this excel-file is locked for using in excel. When I try to open it, there comes a warning that I can only read this file because it is still used by another program. After I have shut down my computer and restart it, the excel-file is writeble again (until I use it again im my program).<br>
Even if I only do this part of my program, it is locked:<br>
            foreach (var worksheet in Workbook.Worksheets(FileName))<br>
            {<br>
                break;<br>
            }<br>
Can you tell me what I can do to solve this?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5383263" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5383263/xlsx-File-in-use-after-reading-cells-in-Csharp.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5383263" data-ref="3_5383263" class="rating-label" name="RateItem_5383263" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5389263_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5389263xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5389263" parent="5383263" thread="5383263" href="https://www.codeproject.com/Messages/5389263/Re-xlsx-File-in-use-after-reading-cells-in-Csharp.aspx">Re: xlsx-File in use after reading cells in C#?</a><div class="mobile-only">
	<span class="author">Member 11706663</span><span class="date">25-Apr-17  8:58</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11706663">Member 11706663</a></span></td><td class="date"><span>25-Apr-17  8:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="11706663" msgid="5389263" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5383263);" href="https://www.codeproject.com/Messages/5383263/xlsx-File-in-use-after-reading-cells-in-Csharp.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I actually read about this in another article. Where if the program isn't successfully cleaned up, and closed. You'll run into awkward problems like so.<br>
https://coderwall.com/p/app3ya/read-excel-file-in-c<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5383263" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5389263/Re-xlsx-File-in-use-after-reading-cells-in-Csharp.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5389263" data-ref="3_5389263" class="rating-label" name="RateItem_5389263" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5408246_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5408246xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5408246" parent="5383263" thread="5383263" href="https://www.codeproject.com/Messages/5408246/Re-xlsx-File-in-use-after-reading-cells-in-Csharp.aspx">Re: xlsx-File in use after reading cells in C#?</a><div class="mobile-only">
	<span class="author">vaynenick</span><span class="date">19-Jun-17  21:13</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10894203">vaynenick</a></span></td><td class="date"><span>19-Jun-17  21:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="10894203" msgid="5408246" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5383263);" href="https://www.codeproject.com/Messages/5383263/xlsx-File-in-use-after-reading-cells-in-Csharp.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>A simple example....<a href="http://csharp.net-informations.com/excel/csharp-read-excel.htm">Read Excel file in C#</a><br>
<br>
Nick<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5383263" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5408246/Re-xlsx-File-in-use-after-reading-cells-in-Csharp.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5408246" data-ref="3_5408246" class="rating-label" name="RateItem_5408246" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5290787_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5290787xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Can i R/W to excel using this ??<div class="mobile-only">
	<span class="author">Member 12698917</span><span class="date">23-Aug-16  22:42</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12698917">Member 12698917</a></span></td><td class="date"><span>23-Aug-16  22:42&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="12698917" msgid="5290787" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">i need to R\W to excel and i was gonna use MS Office interop to Write and this to read but there where some complication with the same package name..I'm new to C# so help me..<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5290787" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5290787/Can-i-R-W-to-excel-using-this.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5290787" data-ref="3_5290787" class="rating-label" name="RateItem_5290787" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5269213_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5269213xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_bug.gif" alt="Bug" title="Bug"></td><td class="subject hover-container">It does not work<div class="mobile-only">
	<span class="author">voquanghoa</span><span class="date">4-Jul-16  8:19</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6632341">voquanghoa</a></span></td><td class="date"><span>4-Jul-16  8:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6632341" msgid="5269213" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Please check my excel file <a href="https://www.dropbox.com/s/g2bpmiwaocx75ek/test.xlsx?dl=0">here<br>
</a>The library does not work on that file, I run the code but every cell is empty<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5269213" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5269213/It-does-not-work.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5269213" data-ref="3_5269213" class="rating-label" name="RateItem_5269213" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5269236_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5269236xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5269236" parent="5269213" thread="5269213" href="https://www.codeproject.com/Messages/5269236/Re-It-does-not-work.aspx">Re: It does not work</a><div class="mobile-only">
	<span class="author">dietmar paul schoder</span><span class="date">4-Jul-16  9:20</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5635146">dietmar paul schoder</a></span></td><td class="date"><span>4-Jul-16  9:20&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5635146" msgid="5269236" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5269213);" href="https://www.codeproject.com/Messages/5269213/It-does-not-work.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I included the source code and a detailed description of how one can work with excel-files. But I am afraid every programmer has to adapt this sample code to his own specific case e.g. by understanding the approach, analysing his data, debugging the program in his environment and adapting it by himself.<br>
<br>
This is, what programmers usually do.<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5269213" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5269236/Re-It-does-not-work.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5269236" data-ref="3_5269236" class="rating-label" name="RateItem_5269236" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5266055_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5266055xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Selecting Worksheets<div class="mobile-only">
	<span class="author">branta.canadensis</span><span class="date">27-Jun-16  4:33</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3495795">branta.canadensis</a></span></td><td class="date"><span>27-Jun-16  4:33&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3495795" msgid="5266055" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Nice library.<br>
<br>
How would I select a specific worksheet by name in a file with multiple worksheets?<br>
<br>
I have a file with 10 or so worksheets and I need to process a specific worksheet.<br>
<br>
Thank you.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5266055" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5266055/Selecting-Worksheets.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5266055" data-ref="3_5266055" class="rating-label" name="RateItem_5266055" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5266060_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5266060xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5266060" parent="5266055" thread="5266055" href="https://www.codeproject.com/Messages/5266060/Re-Selecting-Worksheets.aspx">Re: Selecting Worksheets</a><div class="mobile-only">
	<span class="author">dietmar paul schoder</span><span class="date">27-Jun-16  4:40</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5635146">dietmar paul schoder</a></span></td><td class="date"><span>27-Jun-16  4:40&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5635146" msgid="5266060" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5266055);" href="https://www.codeproject.com/Messages/5266055/Selecting-Worksheets.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Pls. look into the first code lines under "Points Of Interest". There you see, that the collection of worksheets is ordered by their name, and the program iterates through the worksheets. Instead of this iteration you can access the worksheet by name also, as you do it with any collection. Does that help you?<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5266055" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5266060/Re-Selecting-Worksheets.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5266060" data-ref="3_5266060" class="rating-label" name="RateItem_5266060" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5264561_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5264561xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Code skipped<div class="mobile-only">
	<span class="author">Member 12599655</span><span class="date">23-Jun-16  3:45</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12599655">Member 12599655</a></span></td><td class="date"><span>23-Jun-16  3:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="12599655" msgid="5264561" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I used your 3 line code and the program does not enter the first foreach, so basically the 3 line code is entirely skipped. Even if I change the filename to a non existent file it does the same and I don't even get an error.<br>
What could be the problem?<br>
Thanks<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5264561" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5264561/Code-skipped.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5264561" data-ref="3_5264561" class="rating-label" name="RateItem_5264561" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5264583_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5264583xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5264583" parent="5264561" thread="5264561" href="https://www.codeproject.com/Messages/5264583/Re-Code-skipped.aspx">Re: Code skipped</a><div class="mobile-only">
	<span class="author">dietmar paul schoder</span><span class="date">23-Jun-16  4:28</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5635146">dietmar paul schoder</a></span></td><td class="date"><span>23-Jun-16  4:28&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5635146" msgid="5264583" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5264561);" href="https://www.codeproject.com/Messages/5264561/Code-skipped.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>So the program does not find any worksheet in your xlsx-file, I presume. I'm afraid you have to rename your file to .zip, look into into it and try to figure out what is abnormal with it by debugging my code.<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5264561" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5264583/Re-Code-skipped.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5264583" data-ref="3_5264583" class="rating-label" name="RateItem_5264583" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5263516_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5263516xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">How could I read defined names or list of defined names in Name Manager?<div class="mobile-only">
	<span class="author">Member 11169014</span><span class="date">21-Jun-16  2:43</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11169014">Member 11169014</a></span></td><td class="date"><span>21-Jun-16  2:43&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="11169014" msgid="5263516" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi
<br>
Is it possible to read defined names or list of defined names in Name Manager?<br>
<br>
Thanks<br>
Regards<br>
<br>
Leo<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5263516" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5263516/How-could-I-read-defined-names-or-list-of-defined.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5263516" data-ref="3_5263516" class="rating-label" name="RateItem_5263516" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5263551_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5263551xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5263551" parent="5263516" thread="5263516" href="https://www.codeproject.com/Messages/5263551/Re-How-could-I-read-defined-names-or-list-of-defin.aspx">Re: How could I read defined names or list of defined names in Name Manager?</a><div class="mobile-only">
	<span class="author">dietmar paul schoder</span><span class="date">21-Jun-16  4:03</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5635146">dietmar paul schoder</a></span></td><td class="date"><span>21-Jun-16  4:03&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5635146" msgid="5263551" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5263516);" href="https://www.codeproject.com/Messages/5263516/How-could-I-read-defined-names-or-list-of-defined.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>This article shows, how you simple rename a *.xlsx-file to *.zip and look into its content.<br>
<br>
And it shows, how you transform the XML you find in there into C Sharp classes.<br>
<br>
So you can possibly figure out, how things like the one you mention, can be programmed.<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5263516" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5263551/Re-How-could-I-read-defined-names-or-list-of-defin.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5263551" data-ref="3_5263551" class="rating-label" name="RateItem_5263551" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5263959_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5263959xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5263959" parent="5263516" thread="5263516" href="https://www.codeproject.com/Messages/5263959/Re-How-could-I-read-defined-names-or-list-of-defin.aspx">Re: How could I read defined names or list of defined names in Name Manager?</a><div class="mobile-only">
	<span class="author">Member 11169014</span><span class="date">22-Jun-16  1:11</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11169014">Member 11169014</a></span></td><td class="date"><span>22-Jun-16  1:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="11169014" msgid="5263959" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5263516);" href="https://www.codeproject.com/Messages/5263516/How-could-I-read-defined-names-or-list-of-defined.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi
I finally found the way to read Defined Names. I made some changes in the code, basically I read and serialize the file xl/workbook.xml, which contains Defined Names.<br>
Also I found an error when reading some xslt files and adapted Cell.CellReference (ColumnIndex to Cell reference) to allow relating Defined Names with Cells, since ColumnIndex is still accessible due to its public modifier.<br>
So now, plus having the Defined Names we have the complete workbook.xml data which contains additional info in the new property Workbook.WorkbookDefinition<br>
<br>
I posted the complete code on github:<br>
<br>
<a href="https://github.com/LeonardoBluesMan/Excel.Net/">GitHub - Excel.Net: Read Xslx files for .NET plattform (C#)</a><br>
<br>
Thank you<br>
Kind regards<br>
<br>
Leonardo<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5263516" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5263959/Re-How-could-I-read-defined-names-or-list-of-defin.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5263959" data-ref="3_5263959" class="rating-label" name="RateItem_5263959" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5197809_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5197809xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Null value returned on specific &lt;si&gt; elements.<div class="mobile-only">
	<span class="author">Member 12077258</span><span class="date">7-Feb-16  8:56</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12077258">Member 12077258</a></span></td><td class="date"><span>7-Feb-16  8:56&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="12077258" msgid="5197809" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi
<br>
Thanks for posting this it is very helpful for what I am working on. I was just curious if you have found a solution for the following issue. I have been stuck on this for a long time and my attempts to adapt the code to this situation have failed. <br>
<br>
When reading an excel sheet with cells that have character level formatting, the text value returns null for that cell. Looking into the sharedstrings.xml I found that the "&lt; si&gt;" elements that return null during the deserialization of the xml file are the ones that contain two "&lt; t&gt;" elements within the "&lt; si&gt;" element to account for separately formatted text within the same cell. <br>
<br>
Is this a known issue? <br>
<br>
Any direction would be greatly appreciated. <br>
<br>
Thanks<br><br><div class="modified">modified  7-Feb-16 20:50pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5197809" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5197809/Null-value-returned-on-specific-lt-si-gt-elements.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5197809" data-ref="3_5197809" class="rating-label" name="RateItem_5197809" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5197891_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5197891xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5197891" parent="5197809" thread="5197809" href="https://www.codeproject.com/Messages/5197891/Re-Null-value-returned-on-specific-lt-si-gt-elemen.aspx">Re: Null value returned on specific &lt;si&gt; elements.</a><div class="mobile-only">
	<span class="author">dietmar paul schoder</span><span class="date">7-Feb-16  13:06</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5635146">dietmar paul schoder</a></span></td><td class="date"><span>7-Feb-16  13:06&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5635146" msgid="5197891" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5197809);" href="https://www.codeproject.com/Messages/5197809/Null-value-returned-on-specific-lt-si-gt-elements.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Pls. send me your file to dietmar@schoder.uk<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5197809" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5197891/Re-Null-value-returned-on-specific-lt-si-gt-elemen.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5197891" data-ref="3_5197891" class="rating-label" name="RateItem_5197891" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5315198_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx5315198xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5315198" parent="5197891" thread="5197809" href="https://www.codeproject.com/Messages/5315198/Re-Null-value-returned-on-specific-lt-si-gt-elemen.aspx">Re: Null value returned on specific &lt;si&gt; elements.</a><div class="mobile-only">
	<span class="author">ByBlener</span><span class="date">19-Oct-16  3:31</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11133478">ByBlener</a></span></td><td class="date"><span>19-Oct-16  3:31&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="11133478" msgid="5315198" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="56px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5197891);" href="https://www.codeproject.com/Messages/5197891/Re-Null-value-returned-on-specific-lt-si-gt-elemen.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div><pre lang="C#">Hi, I<span class="code-string">'</span><span class="code-string">ve found that when the &lt;si&gt; in the sharedstrings.xml has cell style the &lt;t&gt; will be inside &lt;r&gt;, and &lt;si&gt; can have multiple &lt;r&gt;.
&nbsp;
I'</span>ve added some code to correct that, how can I send it to you?</pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5197809" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5315198/Re-Null-value-returned-on-specific-lt-si-gt-elemen.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5315198" data-ref="3_5315198" class="rating-label" name="RateItem_5315198" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5346275_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5346275xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5346275" parent="5197809" thread="5197809" href="https://www.codeproject.com/Messages/5346275/Re-Null-value-returned-on-specific-lt-si-gt-elemen.aspx">Re: Null value returned on specific &lt;si&gt; elements.</a><div class="mobile-only">
	<span class="author">Cetto</span><span class="date">8-Jan-17  14:14</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=571923">Cetto</a></span></td><td class="date"><span>8-Jan-17  14:14&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="571923" msgid="5346275" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5197809);" href="https://www.codeproject.com/Messages/5197809/Null-value-returned-on-specific-lt-si-gt-elements.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Yes, it's working as intended. How else can 2 different formats be applied within the same cell.<br>
<br>
You can get around it by using string.Join and combining the two &lt;t&gt; elements.<br>
If you're using the original code, you would make changes to <br>
<br>
<pre lang="c#"><span class="code-keyword">if</span> (tType.Equals(<span class="code-string">"</span><span class="code-string">s"</span>))
{
    Text = Workbook.SharedStrings.si[Convert.ToInt32(_value)].t;
    <span class="code-keyword">return</span>;
}</pre><br>
<br>
I used a slightly different approach to the original poster.<br>
<br>
<pre lang="c#">SharedStringItem si = table.GetItemByIndex(c.Value);
&nbsp;
<span class="code-keyword">if</span> (<span class="code-keyword">string</span>.IsNullOrEmpty(si.Text) &amp;&amp; si.Rows.Count <span class="code-keyword">&gt;</span> <span class="code-digit">0</span>)
    <span class="code-keyword">this</span>.Rows[i].Cells[j].Text = <span class="code-keyword">string</span>.Join(<span class="code-string">"</span><span class="code-string">"</span>, si.Rows.Select(r =<span class="code-keyword">&gt;</span> r.Text));
<span class="code-keyword">else</span>
    <span class="code-keyword">this</span>.Rows[i].Cells[j].Text = si.Text;</pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5197809" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5346275/Re-Null-value-returned-on-specific-lt-si-gt-elemen.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5346275" data-ref="3_5346275" class="rating-label" name="RateItem_5346275" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5166256_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5166256xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">xls Extension problem<div class="mobile-only">
	<span class="author">Sonam Mehta</span><span class="date">26-Nov-15  2:45</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5847261">Sonam Mehta</a></span></td><td class="date"><span>26-Nov-15  2:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5847261" msgid="5166256" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hello,<br>
<br>
I really appreciate your code. But this code is only works with xlsx extension only. When I am trying to work with xls extension, it is giving me error<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5166256" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5166256/xls-Extension-problem.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5166256" data-ref="3_5166256" class="rating-label" name="RateItem_5166256" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5166261_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5166261xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5166261" parent="5166256" thread="5166256" href="https://www.codeproject.com/Messages/5166261/Re-xls-Extension-problem.aspx">Re: xls Extension problem</a><div class="mobile-only">
	<span class="author">dietmar paul schoder</span><span class="date">26-Nov-15  2:59</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5635146">dietmar paul schoder</a></span></td><td class="date"><span>26-Nov-15  2:59&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="5635146" msgid="5166261" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl4498647.SwitchMessage(null,5166256);" href="https://www.codeproject.com/Messages/5166256/xls-Extension-problem.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>You can read <a href="https://en.wikipedia.org/wiki/Microsoft_Excel">here</a>:<br>
<br>
"Microsoft Excel up until 2007 version used a proprietary binary file format called Excel Binary File Format (.XLS) as its primary format. Excel 2007 uses Office Open XML as its primary file format."<br>
<br>
You are 8 years behind.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5166256" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5166261/Re-xls-Extension-problem.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5166261" data-ref="3_5166261" class="rating-label" name="RateItem_5166261" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  19:00 &nbsp; &nbsp; Last Update: 22-Dec-17  7:29</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26"><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">2</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=51#xx0xx">3</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=76#xx0xx">4</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=101#xx0xx">5</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=126#xx0xx">6</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=151#xx0xx">7</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=176#xx0xx">8</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=201#xx0xx">9</a> <a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?fid=1864959&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">Next »</a></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p>
				

			</div>
			
		</td>
		<td width="170px" class="article-wing-right">
			<div id="ctl00_RightSideBar" class="container-article-info">

                <div id="RHSticky" class="container-article-info-sticky">
        			

<div class="article-summary">

    

    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top;width:160px;margin: 10px auto;">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-tags="Vista, C#, XML, Windows, .NET, Dev, Office, Intermediate, Win7, MS-Excel, C#5, Win8, .NET4.5, VS2013,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x200&amp;c=396165"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x200&amp;c=396165"  width="160px" height="200px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-tags="Vista, C#, XML, Windows, .NET, Dev, Office, Intermediate, Win7, MS-Excel, C#5, Win8, .NET4.5, VS2013,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x600&amp;c=396165"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x600&amp;c=396165"  width="160px" height="600px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				    </div>

                    

				    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of#_articleTop">Go to top</a>
                    </div>

				</div>

			</div>
		</td>
		</tr></tbody></table>

		
		<div class="theme1-background" style="height:2px" id="stickyStop"></div>

		<div class="extended tiny-text">
			<div class="row">
				<div class="float-left">
					<a id="ctl00_PermaLink" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of">Permalink</a> | 
					<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a> |
					<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a> |
                    <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a> |
					<a id="ctl00_Mobile">Mobile</a>
					<br>
								
					
					Web03 |
					2.8.171207.1 |
					Last Updated 29 Jul 2014								
				</div>

                <div id="ctl00_GoogleTranslate" class="translate float-left"><div class="skiptranslate goog-te-gadget" dir="ltr" style=""><div id=":0.targetLanguage" class="goog-te-gadget-simple" style="white-space: nowrap;"><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/cleardot.gif" class="goog-te-gadget-icon" alt="" style="background-image: url(&quot;https://translate.googleapis.com/translate_static/img/te_ctrl3.gif&quot;); background-position: -65px 0px;"><span style="vertical-align: middle;"><a aria-haspopup="true" class="goog-te-menu-value" href="javascript:void(0)"><span>Select Language</span><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/cleardot.gif" alt="" width="1" height="1"><span style="border-left: 1px solid rgb(187, 187, 187);">​</span><img src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/cleardot.gif" alt="" width="1" height="1"><span aria-hidden="true" style="color: rgb(118, 118, 118);">▼</span></a></span></div></div></div>      

				<div class="float-right align-right">
					Article Copyright 2014 by dietmar paul schoder<br>Everything else
					Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2017 <br>
				</div>

				


<div class="page-width">
Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?PageFlow=FixedWidth">fixed</a>
|
<a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Tips/801032/Csharp-How-To-Read-xlsx-Excel-File-With-Lines-of?PageFlow=Fluid">fluid</a>
</div>



			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div>
</div>


<img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord=&#39;636495425558899586&#39;;dc_seg=33704410?" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript" language="Javascript" src="https://codeproject.global.ssl.fastly.net/script/Articles/JS/article.min.js?dt=2.8.171207.1"></script>
<script type="text/javascript" language="Javascript" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/element.js.download"></script>
<script type="text/javascript" language="Javascript" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/MemberProfilePopup.min.js.download"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
$(document).ready(function () { processCodeBlocks.Initialise('#contentdiv'); });
function googleTranslateElementInit() {  new google.translate.TranslateElement({   pageLanguage: 'en',   layout: google.translate.TranslateElement.InlineLayout.SIMPLE,   autoDisplay: false,   gaTrack: true,   gaId: 'UA-1735123-1'},  'ctl00_GoogleTranslate');}
$(document).ready(function() { anchorAnimate();
$('#RHSticky').sticky($('#stickyStop'));
$('#ctl00_Nav').sticky($('#stickyStop'));
});
$(function ()
                {
                    $('.oauth').click(function () {
                        $this = $(this);
                        href = $this.attr('href');
                        var myWindow = window.open(href, 'popup',
                                    'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
                        myWindow.focus();
                        var timer = setInterval(function () {
                                        if (myWindow.closed) {
                                            clearInterval(timer);
                                            // window.location.reload(); // May do a POST reload, shows a warning
                                            window.location = window.location; // force a GET reload
                                        }
                                    }, 200);
                        return false;
                    });
                });
var retrievalService=function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).bind("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};$(document).ready(function(){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new retrievalService).init()}catch(i){(new retrievalService).init()}};try{t=('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn2.developermedia.com/a.min.js';n.open("GET",t,!0);n.send()}catch(i){(new retrievalService).init()}});
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 if(InitWatermark)InitWatermark('sb_tb', 'Search for articles, questions, tips');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
  sbar.blur(function() {
 if (!oSrchFlt) {sfilter.hide(); sfilter.removeClass('open');}
 srchBoxFoc=false;
 });
  sbar.focus(function() {
 oSrchFlt=false; srchBoxFoc=true;
 sfilter.show(); sfilter.addClass('open');
 });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});

$(function() {
   var bookmark = new Bookmark('[data-type="bookmark"]','https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false);
   bookmark.Initialise();
});
$('#clear-rate_ctl00_RateArticle_RSU').click(function () {    $('#ctl00_RateArticle_RSU').hide(); return false;});$("#ctl00_RateArticle_RateItemWrapper")   .removeClass("container-rating")   .hover( function() { $('#ctl00_RateArticle_RSU').fadeIn('fast'); },            function() { $('#ctl00_RateArticle_RSU').fadeOut('fast'); } );
function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 801032,2,6,true,true,0,'MediumStars', null, ratingAjaxCallback);
}

                        function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                            if (!$('#' + containerId).attr('alreadyRequested')){
                                $.ajax({
                                    url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId,
                                    success: function (data) {
                                        $('#' + containerId).html(data);
                                        $('#' + loadingId).hide();
                                    }
                                });
                                $('#' + containerId).attr('alreadyRequested', 'true');
                            }
                        }
$(document).ready(function() {
  new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
  $('#ctl00_RateArticle_RB').mouseenter(function() {     getVotesHistogram(801032,2   ,'ctl00_RateArticle_Histogram','ctl00_RateArticle_Loading');
  });
})

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(){}

var config4498647 = {
    objectName          : 'forumControl4498647',
    messageTypeId       : 3,
    searchPrompt        : 'Search Comments',
    smoothScroll        : true,
    allowReporting      : false,
    allowRating         : false,
    allowRatingDisplay  : true,
    forumDir            : '/script/Forums/',
    staticServer        : 'https://codeproject.global.ssl.fastly.net',
    switchMsgCallback   : null,
    getVoteFormMethod   : getVoteFormHtml,
    getReportFormMethod : getReportFormHtml,
    voteHiThreshold     : 5 - 0.5,
    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
    getRatingRefKey     : 'obrs',
    reportOptions       : [
       { reportTypeId : 19, name : 'Abusive / Trolling'},
       { reportTypeId : 20, name : 'Inappropriate'},
       { reportTypeId : 5, name : 'Spam'},
    ],
};
var forumControl4498647 = new ForumControl(config4498647, -1);
$(document).ready(function() {
    forumControl4498647.Initialise();
});


//]]>
</script>



<div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 1030px; height: 263px; display: none;" src="./C# How To Read .xlsx Excel File With 3 Lines of Code - CodeProject_files/saved_resource.html"></iframe></body></html>