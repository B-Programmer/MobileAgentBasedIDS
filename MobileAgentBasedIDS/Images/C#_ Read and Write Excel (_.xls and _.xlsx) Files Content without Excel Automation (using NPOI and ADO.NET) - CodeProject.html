<!DOCTYPE html>
<!-- saved from url=(0090)https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con -->
<html style="height: 100%;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>C#: Read and Write Excel (*.xls and *.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject</title> 
	<link type="text/css" rel="stylesheet" href="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.171207.1">

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="2 ways to read and write data to *.xls and *.xls files and display it on DataGridView.; Author: Emiliarge; Updated: 31 Aug 2014; Section: Office Development; Chapter: Enterprise Systems; Updated: 31 Aug 2014">
<meta name="Keywords" content=".NET1.0, .NET1.1, .NET2.0, Win2K, WinXP, Win2003, Vista, C#2.0, .NET3.0, C#3.0, .NET3.5, VS2008, C#, Windows, .NET, Win32, Visual-Studio, DBA,Office Development,Enterprise Systems,Free source code, tutorials">
<meta name="Author" content="Emiliarge">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 



<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "headline": "C#: Read and Write Excel (*.xls and *.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET)",
  "url": "https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con",
  "discussionUrl": "https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C# (C#2.0, C#3.0), Windows (Win2K, WinXP, Win2003, Vista), .NET (.NET1.0, .NET1.1, .NET2.0, .NET3.0, .NET3.5), Win32, Visual-Studio (VS2008), DBA",
  "commentCount": "11",
  "editor" : {
    "@type" : "Person",
    "name" : "Deeksha Shenoy",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3866010"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  }
  "description": "2 ways to read and write data to *.xls and *.xls files and display it on DataGridView.",
  "upvoteCount": "21",
  "articleSection": "Office Development",
  "author" : [{
      "@type" : "Person",
      "name" : "Emiliarge",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=10727401"
    }],
  "datePublished": "2014-08-31",
  "dateCreated": "2014-08-31",
  "dateModified": "2014-08-31",
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.62,
    "ratingCount" : 22,
    "bestRating" : 5,
    "worstRating" : 1
  },
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/9/Enterprise-Systems.aspx",
      "name" : "Enterprise Systems"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/office/",
      "name" : "Office Development"
    }
  }]
}
</script>
	<!--<base target="_top">--><base href="." target="_top">
	<script type="text/javascript" language="Javascript" src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/jquery.min.js.download"></script><script type="text/javascript">//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='%2fscript%2fJS%2fjquery-2.2.4.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
function defrm () { /* thanks twitter */ document.write = ''; window.top.location = window.self.location;  setTimeout(function() { document.body.innerHTML = ''; }, 0);  window.self.onload = function(evt) { document.body.innerHTML = ''; }; }if (window.top !== window.self) {  try {  if (window.top.location.host) { /* will throw */ } else { defrm(); /* chrome */ }  } catch (ex) { defrm(); /* everyone else */ } }if (typeof(DemoUrl)!='undefined')   document.write(unescape('%3Cme')+'ta http'+'-equiv="re'+'fresh"                  con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
$(document).ready(function(){
    $('#__EVENTVALIDATION').attr('autocomplete', 'off');
});

//]]>
</script>

	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/ga.js.download"></script>


<link type="text/css" rel="stylesheet" charset="UTF-8" href="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/translateelement.css"><script type="text/javascript" charset="UTF-8" src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/main.js.download"></script><script type="text/javascript" charset="UTF-8" src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/element_main.js.download"></script></head>	

<body class="chrome chrome63" style="position: relative; min-height: 100%; top: 0px;">

<a class="access-link" href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con#Main"><img alt="Click here to Skip to main content" src="https://codeproject.global.ssl.fastly.net/images/t.gif"></a>





<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix">

	<div id="ctl00_MemberMenu_GenInfo" class="float-left">13,308,534 members (86,872 online)</div>

	<div class="float-left">
		
	</div>

	<div class="float-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con"
				else
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con"
				document.subForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign in</a>
                    <img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/login32.png" width="16px" height="16px" style="vertical-align:middle;">
				</span>

				<div class="tooltip-flyout">
					<form name="subForm" id="subForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con" method="post" class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email"></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password"></div>
						<div class="action">
							
                                  <input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
                                  <input type="hidden" name="fld_quicksign" value="true">
                                  <script type="text/javascript">
                                  function simpleMask(str, key) {
                                      var result = ''; 
                                      for (var i = 0; i < str.length; ++i)
                                          result += String.fromCharCode(key ^ str.charCodeAt(i));
                                      return result;
                                  }
                                  function Join() {
                                      var url = 'https://www.codeproject.com/script/Membership/Modify.aspx';
document.location.href=url;
                                      return false;
                                  }
                                  $('#joinBtn').css('visibility', 'visible');
                                  </script>
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberMenu_SendPassword" class="forgot float-right" href="https://www.codeproject.com/script/Membership/SendPassword.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark">

					Sign in with <a class="oauth" title="Sign in using Github" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Linkedin" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=LinkedIn"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/linkedin.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Facebook" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Google" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Microsoft" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Christmas/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-tags=".NET1.0, .NET1.1, .NET2.0, Win2K, WinXP, Win2003, Vista, C#2.0, .NET3.0, C#3.0, .NET3.5, VS2008, C#, Windows, .NET, Win32, Visual-Studio, DBA,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=130105"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=130105"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div></div>
        </div>
    </div>

	<a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con#Main"><img alt="Click here to Skip to main content" class="access-link" src="https://codeproject.global.ssl.fastly.net/images/t.gif"></a>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="https://www.codeproject.com/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search " id="sb_tb" value="" name="q"></td><td><input type="image" src="https://codeproject.global.ssl.fastly.net/images/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="true"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout">
			<li>
				<div id="siteMap">
					<img src="https://codeproject.global.ssl.fastly.net/images/loading48.gif" alt="loading" style="margin:150px;width:100px;height:100px;">
				</div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="https://www.codeproject.com/search.aspx?sbo=kw">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="https://www.codeproject.com/search.aspx?sbo=kw?aidlst=152&amp;sa_us=True">Beginner Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="https://www.codeproject.com/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly break" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3">Article Competition</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Submit an article or tip
			</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Post your Blog
			</a></li>		<li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Ask a Question</a></li>

		
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions...</a></li>
		
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">Javascript questions</a></li>
			
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable desktop-only"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">features</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
		<li><a id="ctl00_TopNavBar_Research" class="fly" href="https://www.codeproject.com/script/ResearchLibrary/Index.aspx">Research Library</a></li>

		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/MVPWinners.aspx">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li><a id="ctl00_TopNavBar_SoapBoxLnk" class="fly" href="https://www.codeproject.com/Forums/1536756/The-Soapbox.aspx">The Soapbox</a></li>
		<li><a id="ctl00_TopNavBar_PRLnk" class="fly break" href="https://www.codeproject.com/Forums/1738007/Press-Releases.aspx">Press Releases</a></li>

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580230/Chinese.aspx">General Chinese Topics</a></li>
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable desktop-only tablet-only" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">help</a>

	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Site Map</a></li>
		<li><a id="ctl00_TopNavBar_HelpAdvertise" class="fly" href="http://developermedia.com/">Advertise with us</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutAds" class="fly" href="https://www.codeproject.com/info/AboutOurAds.aspx">About our Advertising</a></li>
		<li><a id="ctl00_TopNavBar_HelpJobs" class="fly" href="https://www.codeproject.com/info/Jobs/">Employment Opportunities</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 
	<div class="container-content">


		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/9/Enterprise-Systems.aspx">Enterprise Systems</a> » <a href="https://www.codeproject.com/KB/office/">Office Development</a> » <a href="https://www.codeproject.com/KB/office/#Microsoft+Excel">Microsoft Excel</a></div>
			</div>

            

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				

<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



<span id="ctl00_ActionLinks_BookmarkMd_bookmark" data-type="bookmark" data-ref="2_813187_3" data-size="medium" data-mode="bookmark"></span><a id="ctl00_ActionLinks_PrintMd" href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?display=Print">
	    <img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/print48.png" title="Print" width="24px" height="24px" style="border:0">
    </a>
			</div>
		</div>

		<table class="extended container-article-parts" cellpadding="0" cellspacing="0">
        <tbody><tr valign="top">
		<td width="117px" class="article-wing-left">

			<div id="ctl00_Nav" class="container-article-tabs">
    			

<div class="tabs">
	<div class="selected">Tip/Trick</div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=813187">Browse Code</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=813187">Stats</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=813187">Revisions (3)</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ListAlternatives.aspx?aid=813187">Alternatives</a></div>

	<div class="unselected"><a href="https://www.codeproject.com/Tips/813187/WebControls/#_comments" id="ctl00_ArticleTabs_CommentLink" class="anchorLink">Comments 
        <span id="ctl00_ArticleTabs_CmtCnt">(11)</span></a>
	</div>
</div>	


				<a id="ctl00_AddAlternative" title="Write a related article about upgrades or translate this into a different language." class="add-item" href="https://www.codeproject.com/script/Articles/SubmissionWizard.aspx?at=6&amp;apid=813187">Add your own<br>alternative version</a>

			    <div>
                    <h4>Tagged as</h4>
			        <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET1.0" data-id="10">.NET1.0</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET1.1" data-id="11">.NET1.1</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET2.0" data-id="12">.NET2.0</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Win2K" data-id="23">Win2K</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/WinXP" data-id="24">WinXP</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Win2003" data-id="26">Win2003</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Vista" data-id="27">Vista</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C--hash--2.0" data-id="65">C#2.0</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET3.0" data-id="66">.NET3.0</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C--hash--3.0" data-id="69">C#3.0</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET3.5" data-id="76">.NET3.5</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VS2008" data-id="77">VS2008</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C--hash--" data-id="81">C#</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/.NET" data-id="98">.NET</a></div></span><acronym id="ctl00_TagList_HiddenTags" title="plus: Win32, Visual-Studio, DBA">, +</acronym> 

	
	
</span>


			    </div>

                <div class="stats">
                <h4>Stats</h4>
                <div id="ctl00_ArtStats"><div class="stats"><div>206.9K views</div><div>16.5K downloads</div><div>76 bookmarked</div></div></div>
                </div>

                <div class="subdue padded-top" title="Date First posted">Posted 
                    30 Aug 2014</div>

                <div title="Licence">
                    <a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                </div>

                
			</div>

		</td>
		<td>
			
			<div id="AT" class="container-article  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="Sqi6V7bxU4/ne5CBA8a12QaHwE1amYS8k25vkoLHPZ9WG+poCYUpl8dvBvNGtfi6vcru/j4i/Rg6viWyIQl9xu2Ej4dXD1Lc58ydViBEGtlaNfTThXvHO/A7bOB524mPHuJkBePRJDl0Un8I7oim+ktMMtO2+dOo9cndAXuBl/I5f/0TwVRJrjgM1TjqBXpC4o6TftJPk0uwNoLFF9KvxsE1Q6J17Wj9XfFd6Oj+bdW7KS24vT/yjUGcEfJwx+j/Th2xTK+eeLEYNhG3KQXE1DqoTn27+vTzJ4uBQ7FMuVtsyeDG8iiPr4EJV0S1VkeB/uYOY/uEQ2j3tE9yi68nQ6RRlSTImgGXITMXre4iYPQw7CASksTAr277c91qkWRx1SL7bSVJVTxdZRKNwd2JNu+DQAdXfPhdU9HwXNucuSQ5lX/zbIkM4cHVPrhSb4eZpbykvvvywLo0IozNkevOnYVW1gF/PqDrIfh4Z1in5aYfNKyRx0T50iViggsSQXQ0wJETlejKMPRzjxoTL28MwxAitu+gvb3S+YokbR+mZN6ZaVvcTCqvKz6x47bqQZFDMf21zQ5x19PDAvOvegBtwCkF+NvJn8+WPAh8vdKmisT9d6yVHNYbw/N6LxoXPg5x9iv1Bw+iOQfzNYTOwWm6lRjxmt/GEGphf+2QpueNeoFJ39YNNN2/dyIHZew9w+4Bu8ANKpaJJMLACqX4/GcZqLkRZZYcwl3BmxJiHK7sBsouGGo7vFRl7EY/IIE0isjgibkLeXBCTnYT69b083X84Vp1qiaBniOAr044CxfZQGq5mEh0jlJKg2TjbYDX2SDb2VsnHwEVaEEVKoLkMp3e3Wn93NcpjN1zQBESi7IDEw5S50tHtgUTSqR6lrBbqW8RDlvgZf0SEZ8rTSoI0L8PhWzdKw0VDhHfe3hoL9rKc5qTHah8IQ/unPuk8SsKcYv4Esq5MTwKR9+WexmDdOh5sJgc/tkGui+p3F+s7dMKfbMn5J9uuNoVbeJWdMyclw/w7CrG/CFlMiGxShzNbDtK+QoTMqE5uKmr7glGlmZZaY4Bw9mpMFWgVRBY0Y1iq5sh83vwaFlWXh76N58Zv86mh7VXlAq2d564i1ZiHy3p4CDihF+swJj+FNRwwmbo77eQBk1jx7IiRSbYpnoQY+UQjS8Tsx8Cy4ynqH2VFN/9BGi2nXUJNWhlHQsKsq78svx0LuvWV2X+bnX14sPuA18+JPsgRkRAjVfVSoNqIAmkkzTiOZkStbwKNf/EeXHCcj6Xou1nebHTkXG9RI7Rape8Z8LAUcjYEziNA9MyZCkk+uXqz3wYEgnl2WF8gRdGq9si+Ps8lr3E5KDDdErw/xVB/tXDrf0xIG+2SAI7NkXQ79bS/T13D91tN0rXaSguuAPfK5k5+d6pZ/dxt+k/G6ZakhWQEExoDrBZPg6RkopF7SXG6959faZ0WuOk5qrg/6Hpb3XIWrBID/J3A88blBt326YA0+pxXYvC3I8gL9WUu/0Lgj12QAdoUl7UXXhaGQJ5ltnMLXyK5LmASjJtf1wfbKhbTqgX4LAFRNWPC7mRywOuQQ5/2CakMAy883DHHQ/kQaQsDLSG/ATo/jR3/a+HiXXmxgbPzwOYgo2AVeF6tJCPibjFU+4gdtATrj2Mpxx8kp05LBIHahGVTUX7jue9Sq3FA3YvGw2/jnG5Z9VyLTkQnok1e19RIGvzF70id/zArkzo2taUjduPPII3H9Zsf4kUr647R94X09qPgt4NYJsZ88BcafYGZF/Zjh9aqSCSWDt07K/twUbHJ/Ht75nK0L5VvaM66w7xRBr1542ey19GH0hcNiG0CtzPt2/pKpyVEx9opb6PvCApkyZHX44nIR7ZxvddNVL2uRFHolg8f+hoAGuY2leJlL9gXe5zOpQxGeGyJi4s4W5rO+VTWzaOAec8GNERWINCuCK+jNkRvUijWzdLORX7hQsIqZfHOJngDuQ/aOWdwrKZIs4UYIcRj1U9iH0R0joUrOOmTo+e+2dYpQAXl8Zax2EdvOzxDamf3y19YDSB78ETnJ1djsj3cD2a/XN49n6FATA8InnVhfbi22NuNTfibywqzo8Q3PKY/mdOGd4Jpc806dk2A2VFvNTIOhyiNKs+73HwN5NAjKtTQIhlnLa5VsKnFlenLj9QlkzTEf+7QaEm95QXxpwSNbafhCvicj1/Zk4LMOTmAbrJ0LUKWFIkBen1wF7H+UzOAILq7Q==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">C#: Read and Write Excel (*.xls and *.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET)</h1>
					    </div>

                        <div style="height:34px">
					        
					        <div class="entry float-left">

                                

                                <div class="float-left">
                                    <div>
						                <span class="author"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10727401" rel="author">Emiliarge</a></span>, 
						                <span class="date" title="Date last updated">
							            30 Aug 2014</span>
			                        </div>

                                    
						            <div id="ctl00_RateArticleRow" class="float-left align-right" style="margin-top:5px">

					                    <div id="ctl00_CurRat" class="tooltip anchorLink column" style="cursor:pointer;margin:2px 20px 0 0" name="CurRat_813187">
				
							                

<table id="ctl00_ArticleRating_RatingTable" cellpadding="0" cellspacing="0" class="small-text">
	<tbody><tr>
		<td class="nowrap">

		<span id="ctl00_ArticleRating_VI">
		<div class="nowrap rating-stars-medium" style="height:18px;width:80px;position:relative;">
			<div class="clipped align-left float-left" style="height:16px;width:73px;">
				<img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-fill-md.png" style="border-width:0px;">
			</div><div class="clipped" style="height:16px;width:7px;position:relative;">
				<img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-empty-md.png" style="border-width:0px;position:absolute;top:0;right:0;">
			</div>
		</div>
		</span>

		
	</td>
		<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;
		<span id="ctl00_ArticleRating_VotesR">&nbsp;4.62 (22 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_ArticleRating_RatingText"></span>


							                <div id="ctl00_RB" class="speech-bubble-container-up">
								                <div class="speech-bubble-up" style="width:150px !important">
									                            
<div>
<table class="feature" width="100%" height="50px" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0"><tbody><tr class="chart-row"><td class="chart-column"><div class="rating-ignore-vote" title="Votes not included in score."><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="3px" border="0px" alt="1 vote, 4.8%" title="1 vote, 4.8%"></div><span title="0 votes">1</span></td>
<td class="chart-column"><span title="0 votes">2</span></td>
<td class="chart-column"><span title="0 votes">3</span></td>
<td class="chart-column"><div><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="15px" border="0px" alt="5 votes, 23.8%" title="5 votes, 23.8%"></div><span title="5 votes">4</span></td>
<td class="chart-column"><div><img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="50px" border="0px" alt="16 votes, 76.2%" title="16 votes, 76.2%"></div><span title="16 votes">5</span></td>
</tr></tbody></table><div class="small-text align-center">4.62/5 - 22 votes</div><div class="small-text align-center subdue">1 removed</div><div class="small-text align-center subdue">μ 4.44, σ<sub>a</sub> 1.62 [<a href="https://www.codeproject.com/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]</div>
</div>
								                </div>
								                <div class="speech-bubble-pointer-up">
									                <div class="speech-bubble-pointer-up-inner"></div>
								                </div>
							                </div>

						                </div>
                                        <div class="column">
                                        <div id="ctl00_RateArticle_RateItemWrapper" class="small-text" name="RateItem_813187">

	<table width="100%" cellpadding="0" cellspacing="0" class="small-text">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" width="16px" alt="loading..." height="16px" src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/loading16.gif"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				<td id="ctl00_RateArticle_RateText" class="rating-prompt">
					Rate this:
				</td>

				
				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap rating-stars-voter-medium">
					

					<span id="ctl00_RateArticle_RB" class="tooltip ajaxHist radio voting">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5"></span> 

						
					</span>

				</td>

				
				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button">
				</td>
			</tr>
			</tbody></table>
			
		</td>
	</tr>
	</tbody></table>
	<div class="hover-container">
		
        <div id="ctl00_RateArticle_RSU" class="rating-comment align-left float-right">
            <div class="padded">
            Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign up or sign in</a> to vote.
            </div>
        </div>
	</div>
</div>
                                        </div>
                                    
                                    </div>
    						        	

                                </div>

    	                        	
                                <div class="float-left" style="margin: 25px 0 0 10px;">
	                                
	                            </div>
                         	    	
    
					        </div>

                            

						    

                        </div>

                        <div id="ctl00_description" class="summary">2 ways to read and write data to *.xls and *.xls files and display it on DataGridView.</div><span id="ctl00_thumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/tip100x80.png"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
    <li><a href="https://www.codeproject.com/KB/office/813187/Read___write_XLS_via_NPOI___display_in_GRID.zip">Download Read___write_XLS_via_NPOI___display_in_GRID - 605.8 KB</a></li>    <li><a href="https://www.codeproject.com/KB/office/813187/Read___write_XLS_via_ADO.NET___display_in_GRID.zip">Download Read___write_XLS_via_ADO.NET___display_in_GRID - 47.7 KB</a></li>    <li><a href="https://www.codeproject.com/KB/office/813187/Read___write_XLSX_via_NPOI___display_in_GRID.zip">Download Read___write_XLSX_via_NPOI___display_in_GRID - 1.4 MB</a></li>    <li><a href="https://www.codeproject.com/KB/office/813187/Read___write_XLSX_via_ADO.NET___display_in_GRID.zip">Download Read___write_XLSX_via_ADO.NET___display_in_GRID - 64 KB</a></li></ul>

<h2>Way 1. Using ADO.NET - Microsoft.Jet.OleDb.4.0 (xls) and Microsoft.Jet.ACE.DB.*.0 (xlsx) Providers</h2>

<p>Provider Microsoft.Jet.OleDb.4.0 is fully native way to read and write XLS files. It is pre-installed on Windows 2000 and later.</p>

<p>Using this, you can read and write XLS files as databases by using SQL queries.</p>

<pre lang="cs"><span class="code-keyword">using</span> System;
<span class="code-keyword">using</span> System.Collections.Generic;
<span class="code-keyword">using</span> System.ComponentModel;
<span class="code-keyword">using</span> System.Data;
<span class="code-keyword">using</span> System.Drawing;
<span class="code-keyword">using</span> System.Linq;
<span class="code-keyword">using</span> System.Text;
<span class="code-keyword">using</span> System.Windows.Forms;

<span class="code-keyword">using</span> System.Data.OleDb;

<span class="code-keyword">namespace</span> Read___write_xls___display_in_grid
{
    <span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> Form1 : Form
    {
        OleDbConnection conn;
        OleDbDataAdapter adapter;

        DataTable dt;

        <span class="code-keyword">public</span> Form1()
        {
            InitializeComponent();
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> Form1_Load(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-comment">//</span><span class="code-comment"> connect to xls file</span>
            <span class="code-comment">//</span><span class="code-comment"> NOTE: it will be created if not exists</span>
            conn = <span class="code-keyword">new</span> OleDbConnection(<span class="code-string">"</span><span class="code-string">Provider=Microsoft.Jet.OleDb.4.0;"</span> +
                <span class="code-string">"</span><span class="code-string">Data Source="</span> + Application.StartupPath + <span class="code-string">"</span><span class="code-string">\\test.xls;"</span> +
                <span class="code-string">"</span><span class="code-string">Extended Properties=Excel 8.0"</span>);
            conn.Open();

            <span class="code-comment">//</span><span class="code-comment"> create a sheet "Sheet1" if not exists</span>
            <span class="code-comment">//</span><span class="code-comment"> NOTE: no "id" field needed</span>
            <span class="code-comment">//</span><span class="code-comment"> WARNING: spaces in sheet's name are supported if names are in [] (automatically replace with _)</span>
            <span class="code-comment">//</span><span class="code-comment"> spaces in column names NOT supported with OleDbCommandBuilder!</span>
            <span class="code-keyword">try</span>
            {
                <span class="code-keyword">string</span> cmdText = <span class="code-string">"</span><span class="code-string">CREATE TABLE [Sheet 1] (text_col MEMO, int_col INT)"</span>;
                <span class="code-keyword">using</span> (OleDbCommand cmd = <span class="code-keyword">new</span> OleDbCommand(cmdText, conn))
                {
                    cmd.ExecuteNonQuery();
                }
            }
            <span class="code-keyword">catch</span> { }

            <span class="code-comment">//</span><span class="code-comment"> get sheets list into combobox</span>
            dt = conn.GetSchema(<span class="code-string">"</span><span class="code-string">Tables"</span>);
            <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> dt.Rows.Count - <span class="code-digit">1</span>; i++)
            {
                <span class="code-keyword">if</span> (dt.Rows[i].ItemArray[dt.Columns.IndexOf
                (<span class="code-string">"</span><span class="code-string">TABLE_TYPE"</span>)].ToString() == <span class="code-string">"</span><span class="code-string">TABLE"</span> &amp;&amp;
                    !dt.Rows[i].ItemArray[dt.Columns.IndexOf
                    (<span class="code-string">"</span><span class="code-string">TABLE_NAME"</span>)].ToString().Contains(<span class="code-string">"</span><span class="code-string">$"</span>))
                {
                    comboBox1.Items.Add(dt.Rows[i].ItemArray[dt.Columns.IndexOf(<span class="code-string">"</span><span class="code-string">TABLE_NAME"</span>)]);
                }
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> button1_Click(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            adapter = <span class="code-keyword">new</span> OleDbDataAdapter(<span class="code-string">"</span><span class="code-string">SELECT * FROM "</span> + comboBox1.SelectedItem.ToString(), conn);

            <span class="code-keyword">new</span> OleDbCommandBuilder(adapter);

            dt = <span class="code-keyword">new</span> DataTable();
            adapter.Fill(dt);
            dataGridView1.DataSource = dt;
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> Form1_FormClosed(<span class="code-keyword">object</span> sender, FormClosedEventArgs e)
        {
            <span class="code-keyword">if</span> (adapter == <span class="code-keyword">null</span>) <span class="code-keyword">return</span>;

            adapter.Update(dt);
        }

        <span class="code-comment">//</span><span class="code-comment"> show tooltip (not intrusive MessageBox) when user trying to input letters into INT column cell</span>
        <span class="code-keyword">private</span> <span class="code-keyword">void</span> dataGridView1_DataError(<span class="code-keyword">object</span> sender, DataGridViewDataErrorEventArgs e)
        {
            <span class="code-keyword">if</span> (dt.Columns[e.ColumnIndex].DataType == <span class="code-keyword">typeof</span>(<span class="code-sdkkeyword">Double</span>))
            {
                Rectangle rectColumn;
                rectColumn = dataGridView1.GetColumnDisplayRectangle(e.ColumnIndex, <span class="code-keyword">false</span>);

                Rectangle rectRow;
                rectRow = dataGridView1.GetRowDisplayRectangle(e.RowIndex, <span class="code-keyword">false</span>);

                toolTip1.ToolTipTitle = <span class="code-string">"</span><span class="code-string">This field is for integers and decimals only."</span>;
                toolTip1.Show(<span class="code-string">"</span><span class="code-string"> "</span>,
                          dataGridView1,
                          rectColumn.Left, rectRow.Top + rectRow.Height);
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> dataGridView1_MouseDown(<span class="code-keyword">object</span> sender, MouseEventArgs e)
        {
            toolTip1.Hide(dataGridView1);
        }
    }
}</pre>

<p>Also, you can use Microsoft.ACE.OLEDB.*.0 providers for XLSX file reading.</p>

<p>One of these providers is included in Microsoft Office / Microsoft Office Primary Interop Assemblies.</p>

<pre lang="cs"><span class="code-keyword">using</span> System;
<span class="code-keyword">using</span> System.Collections.Generic;
<span class="code-keyword">using</span> System.ComponentModel;
<span class="code-keyword">using</span> System.Data;
<span class="code-keyword">using</span> System.Drawing;
<span class="code-keyword">using</span> System.Linq;
<span class="code-keyword">using</span> System.Text;
<span class="code-keyword">using</span> System.Windows.Forms;

<span class="code-keyword">using</span> System.Data.OleDb;

<span class="code-keyword">namespace</span> Read___write_XLSX_via_ADO.NET___display_in_GRID
{
    <span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> Form1 : Form
    {
        OleDbConnection conn;
        OleDbDataAdapter adapter;

        DataTable dt;

        <span class="code-keyword">public</span> Form1()
        {
            InitializeComponent();
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> Form1_Load(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-comment">//</span><span class="code-comment"> connect to xls file</span>
            <span class="code-comment">//</span><span class="code-comment"> NOTE: it will be created if not exists</span>
            <span class="code-keyword">try</span>
            {
                conn = <span class="code-keyword">new</span> OleDbConnection(<span class="code-string">"</span><span class="code-string">Provider=Microsoft.ACE.OLEDB.12.0;"</span> +
                    <span class="code-string">"</span><span class="code-string">Data Source="</span> + Application.StartupPath + <span class="code-string">"</span><span class="code-string">\\test.xlsx;"</span> +
                    <span class="code-string">"</span><span class="code-string">Extended Properties=Excel 12.0 Xml"</span>);
                conn.Open();
            }
            <span class="code-keyword">catch</span>
            {
                <span class="code-keyword">try</span>
                {
                    conn = <span class="code-keyword">new</span> OleDbConnection(<span class="code-string">"</span><span class="code-string">Provider=Microsoft.ACE.OLEDB.14.0;"</span> +
                        <span class="code-string">"</span><span class="code-string">Data Source="</span> + Application.StartupPath + <span class="code-string">"</span><span class="code-string">\\test.xlsx;"</span> +
                        <span class="code-string">"</span><span class="code-string">Extended Properties=Excel 14.0 Xml"</span>);
                    conn.Open();
                }
                <span class="code-keyword">catch</span>
                {
                    <span class="code-keyword">try</span>
                    {
                        conn = <span class="code-keyword">new</span> OleDbConnection(<span class="code-string">"</span><span class="code-string">Provider=Microsoft.ACE.OLEDB.15.0;"</span> +
                            <span class="code-string">"</span><span class="code-string">Data Source="</span> + Application.StartupPath + <span class="code-string">"</span><span class="code-string">\\test.xlsx;"</span> +
                            <span class="code-string">"</span><span class="code-string">Extended Properties=Excel 15.0 Xml"</span>);
                        conn.Open();
                    }
                    <span class="code-keyword">catch</span>
                    {
                    }
                }
            }

            <span class="code-comment">//</span><span class="code-comment"> create a sheet "Sheet1" if not exists</span>
            <span class="code-comment">//</span><span class="code-comment"> NOTE: no "id" field needed</span>
            <span class="code-comment">//</span><span class="code-comment"> WARNING: spaces in sheet's name are supported if names are in [] (automatically replace with _)</span>
            <span class="code-comment">//</span><span class="code-comment"> spaces in column names NOT supported with OleDbCommandBuilder!</span>
            <span class="code-keyword">try</span>
            {
                <span class="code-keyword">string</span> cmdText = <span class="code-string">"</span><span class="code-string">CREATE TABLE [Sheet 1] (text_col MEMO, int_col INT)"</span>;
                <span class="code-keyword">using</span> (OleDbCommand cmd = <span class="code-keyword">new</span> OleDbCommand(cmdText, conn))
                {
                    cmd.ExecuteNonQuery();
                }
            }
            <span class="code-keyword">catch</span> { }

            <span class="code-comment">//</span><span class="code-comment"> get sheets list into combobox</span>
            dt = conn.GetSchema(<span class="code-string">"</span><span class="code-string">Tables"</span>);
            <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> dt.Rows.Count - <span class="code-digit">1</span>; i++)
            {
                <span class="code-keyword">if</span> (dt.Rows[i].ItemArray[dt.Columns.IndexOf(<span class="code-string">"</span><span class="code-string">TABLE_TYPE"</span>)].ToString() == <span class="code-string">"</span><span class="code-string">TABLE"</span> &amp;&amp;
                    !dt.Rows[i].ItemArray[dt.Columns.IndexOf(<span class="code-string">"</span><span class="code-string">TABLE_NAME"</span>)].ToString().Contains(<span class="code-string">"</span><span class="code-string">$"</span>))
                {
                    comboBox1.Items.Add(dt.Rows[i].ItemArray[dt.Columns.IndexOf(<span class="code-string">"</span><span class="code-string">TABLE_NAME"</span>)]);
                }
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> button1_Click(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            adapter = <span class="code-keyword">new</span> OleDbDataAdapter(<span class="code-string">"</span><span class="code-string">SELECT * FROM "</span> + comboBox1.SelectedItem.ToString(), conn);

            <span class="code-keyword">new</span> OleDbCommandBuilder(adapter);

            dt = <span class="code-keyword">new</span> DataTable();
            adapter.Fill(dt);
            dataGridView1.DataSource = dt;
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> Form1_FormClosed(<span class="code-keyword">object</span> sender, FormClosedEventArgs e)
        {
            <span class="code-keyword">if</span> (adapter == <span class="code-keyword">null</span>) <span class="code-keyword">return</span>;

            adapter.Update(dt);
        }

        <span class="code-comment">//</span><span class="code-comment"> show tooltip (not intrusive MessageBox) when user trying to input letters into INT column cell</span>
        <span class="code-keyword">private</span> <span class="code-keyword">void</span> dataGridView1_DataError(<span class="code-keyword">object</span> sender, DataGridViewDataErrorEventArgs e)
        {
            <span class="code-keyword">if</span> (dt.Columns[e.ColumnIndex].DataType == <span class="code-keyword">typeof</span>(<span class="code-sdkkeyword">Double</span>))
            {
                Rectangle rectColumn;
                rectColumn = dataGridView1.GetColumnDisplayRectangle(e.ColumnIndex, <span class="code-keyword">false</span>);

                Rectangle rectRow;
                rectRow = dataGridView1.GetRowDisplayRectangle(e.RowIndex, <span class="code-keyword">false</span>);

                toolTip1.ToolTipTitle = <span class="code-string">"</span><span class="code-string">This field is for integers and decimals only."</span>;
                toolTip1.Show(<span class="code-string">"</span><span class="code-string"> "</span>,
                          dataGridView1,
                          rectColumn.Left, rectRow.Top + rectRow.Height);
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> dataGridView1_MouseDown(<span class="code-keyword">object</span> sender, MouseEventArgs e)
        {
            toolTip1.Hide(dataGridView1);
        }
    }
}</pre>

<p>But note that Jet and ACE providers are using for Excel files NOT that method of reading, which they use for Access databases, so <strong>they reading Excel files NOT as fast as databases</strong>.</p>

<h2>Way 2. Using NPOI Library</h2>

<p><a href="http://npoi.codeplex.com/">NPOI</a> is open-source third-party library which can be using for xls, xlsx, docx files reading and writing.</p>

<p lang="cs">It doesn't require Microsoft Excel and any other third-party apps/libraries.</p>

<h3>XLS </h3>

<pre lang="cs"><span class="code-keyword">using</span> System;
<span class="code-keyword">using</span> System.Collections.Generic;
<span class="code-keyword">using</span> System.ComponentModel;
<span class="code-keyword">using</span> System.Data;
<span class="code-keyword">using</span> System.Drawing;
<span class="code-keyword">using</span> System.Linq;
<span class="code-keyword">using</span> System.Text;
<span class="code-keyword">using</span> System.Windows.Forms;

<span class="code-keyword">using</span> System.IO;

<span class="code-keyword">using</span> NPOI.HSSF.Model; <span class="code-comment">//</span><span class="code-comment"> InternalWorkbook</span>
<span class="code-keyword">using</span> NPOI.HSSF.UserModel; <span class="code-comment">//</span><span class="code-comment"> HSSFWorkbook, HSSFSheet</span>

<span class="code-keyword">namespace</span> Read___write_XLS_via_NPOI___display_in_GRID
{
    <span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> Form1 : Form
    {
        HSSFWorkbook wb;
        HSSFSheet sh;

        <span class="code-keyword">public</span> Form1()
        {
            InitializeComponent();
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> Form1_Load(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-comment">//</span><span class="code-comment"> create xls if not exists</span>
            <span class="code-keyword">if</span> (!File.Exists(<span class="code-string">"</span><span class="code-string">test.xls"</span>))
            {
                wb = HSSFWorkbook.Create(InternalWorkbook.CreateWorkbook());

                <span class="code-comment">//</span><span class="code-comment"> create sheet</span>
                sh = (HSSFSheet)wb.CreateSheet(<span class="code-string">"</span><span class="code-string">Sheet1"</span>);
                <span class="code-comment">//</span><span class="code-comment"> 3 rows, 2 columns</span>
                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> <span class="code-digit">3</span>; i++)
                {
                    <span class="code-keyword">var</span> r = sh.CreateRow(i);
                    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> <span class="code-digit">2</span>; j++)
                    {
                        r.CreateCell(j);
                    }
                }

                <span class="code-keyword">using</span> (<span class="code-keyword">var</span> fs = <span class="code-keyword">new</span> FileStream(<span class="code-string">"</span><span class="code-string">test.xls"</span>, FileMode.Create, FileAccess.Write))
                {
                    wb.Write(fs);
                }
            }

            <span class="code-comment">//</span><span class="code-comment"> get sheets list from xls</span>
            <span class="code-keyword">using</span> (<span class="code-keyword">var</span> fs = <span class="code-keyword">new</span> FileStream(<span class="code-string">"</span><span class="code-string">test.xls"</span>, FileMode.Open, FileAccess.Read))
            {
                wb = <span class="code-keyword">new</span> HSSFWorkbook(fs);

                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> wb.Count; i++)
                {
                    comboBox1.Items.Add(wb.GetSheetAt(i).SheetName);
                }
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> button1_Click(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-comment">//</span><span class="code-comment"> clear grid before filling</span>
            dataGridView1.Rows.Clear();
            dataGridView1.Columns.Clear();

            <span class="code-comment">//</span><span class="code-comment"> get sheet</span>
            sh = (HSSFSheet)wb.GetSheet(comboBox1.SelectedItem.ToString());

            <span class="code-keyword">int</span> i = <span class="code-digit">0</span>;
            <span class="code-keyword">while</span> (sh.GetRow(i) != <span class="code-keyword">null</span>)
            {
                <span class="code-comment">//</span><span class="code-comment"> add necessary columns</span>
                <span class="code-keyword">if</span> (dataGridView1.Columns.Count <span class="code-keyword">&lt;</span> sh.GetRow(i).Cells.Count)
                {
                    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> sh.GetRow(i).Cells.Count; j++)
                    {
                        dataGridView1.Columns.Add(<span class="code-string">"</span><span class="code-string">"</span>, <span class="code-string">"</span><span class="code-string">"</span>);
                    }
                }
                
                <span class="code-comment">//</span><span class="code-comment"> add row</span>
                dataGridView1.Rows.Add();
                
                <span class="code-comment">//</span><span class="code-comment"> write row value</span>
                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> sh.GetRow(i).Cells.Count; j++)
                {
                    <span class="code-keyword">var</span> cell = sh.GetRow(i).GetCell(j);

                    <span class="code-keyword">if</span> (cell != <span class="code-keyword">null</span>)
                    {
                        <span class="code-comment">//</span><span class="code-comment"> TODO: you can add more cell types capability, e. g. formula</span>
                        <span class="code-keyword">switch</span> (cell.CellType)
                        {
                            <span class="code-keyword">case</span> NPOI.SS.UserModel.CellType.Numeric:
                                dataGridView1[j, i].Value = sh.GetRow(i).GetCell(j).NumericCellValue;
                                <span class="code-keyword">break</span>;
                            <span class="code-keyword">case</span> NPOI.SS.UserModel.CellType.<span class="code-sdkkeyword">String</span>:
                                dataGridView1[j, i].Value = sh.GetRow(i).GetCell(j).StringCellValue;
                                <span class="code-keyword">break</span>;
                        }
                    }
                }

                i++;
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> button2_Click(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> dataGridView1.RowCount - <span class="code-digit">1</span>; i++)
            {
                <span class="code-keyword">if</span> (sh.GetRow(i) == <span class="code-keyword">null</span>)
                    sh.CreateRow(i);

                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> dataGridView1.ColumnCount; j++)
                {
                    <span class="code-keyword">if</span> (sh.GetRow(i).GetCell(j) == <span class="code-keyword">null</span>)
                        sh.GetRow(i).CreateCell(j);

                    <span class="code-keyword">if</span> (dataGridView1[j, i].Value != <span class="code-keyword">null</span>)
                    {
                        sh.GetRow(i).GetCell(j).SetCellValue(dataGridView1[j, i].Value.ToString());
                    }
                }
            }

            <span class="code-keyword">using</span> (<span class="code-keyword">var</span> fs = <span class="code-keyword">new</span> FileStream(<span class="code-string">"</span><span class="code-string">test.xls"</span>, FileMode.Open, FileAccess.Write))
            {
                wb.Write(fs);
            }
        }
    }
}</pre>

<h3>XLSX </h3>

<pre lang="cs"><span class="code-keyword">using</span> System;
<span class="code-keyword">using</span> System.Collections.Generic;
<span class="code-keyword">using</span> System.ComponentModel;
<span class="code-keyword">using</span> System.Data;
<span class="code-keyword">using</span> System.Drawing;
<span class="code-keyword">using</span> System.Linq;
<span class="code-keyword">using</span> System.Text;
<span class="code-keyword">using</span> System.Windows.Forms;

<span class="code-keyword">using</span> System.IO; <span class="code-comment">//</span><span class="code-comment"> File.Exists()</span>

<span class="code-keyword">using</span> NPOI.XSSF.UserModel; <span class="code-comment">//</span><span class="code-comment"> XSSFWorkbook, XSSFSheet</span>

<span class="code-keyword">namespace</span> Read___write_XLSX_via_NPOI___display_in_GRID
{
    <span class="code-keyword">public</span> <span class="code-keyword">partial</span> <span class="code-keyword">class</span> Form1 : Form
    {
        XSSFWorkbook wb;
        XSSFSheet sh;

        <span class="code-keyword">public</span> Form1()
        {
            InitializeComponent();
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> Form1_Load(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-comment">//</span><span class="code-comment"> create xls if not exists</span>
            <span class="code-keyword">if</span> (!File.Exists(<span class="code-string">"</span><span class="code-string">test.xlsx"</span>))
            {
                wb = <span class="code-keyword">new</span> XSSFWorkbook();

                <span class="code-comment">//</span><span class="code-comment"> create sheet</span>
                sh = (XSSFSheet)wb.CreateSheet(<span class="code-string">"</span><span class="code-string">Sheet1"</span>);
                <span class="code-comment">//</span><span class="code-comment"> 3 rows, 2 columns</span>
                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> <span class="code-digit">3</span>; i++)
                {
                    <span class="code-keyword">var</span> r = sh.CreateRow(i);
                    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> <span class="code-digit">2</span>; j++)
                    {
                        r.CreateCell(j);
                    }
                }

                <span class="code-keyword">using</span> (<span class="code-keyword">var</span> fs = <span class="code-keyword">new</span> FileStream(<span class="code-string">"</span><span class="code-string">test.xlsx"</span>, FileMode.Create, FileAccess.Write))
                {
                    wb.Write(fs);
                }
            }

            <span class="code-comment">//</span><span class="code-comment"> get sheets list from xlsx</span>
            <span class="code-keyword">using</span> (<span class="code-keyword">var</span> fs = <span class="code-keyword">new</span> FileStream(<span class="code-string">"</span><span class="code-string">test.xlsx"</span>, FileMode.Open, FileAccess.Read))
            {
                wb = <span class="code-keyword">new</span> XSSFWorkbook(fs);

                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> wb.Count; i++)
                {
                    comboBox1.Items.Add(wb.GetSheetAt(i).SheetName);
                }
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> button1_Click(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-comment">//</span><span class="code-comment"> clear grid before filling</span>
            dataGridView1.Rows.Clear();
            dataGridView1.Columns.Clear();

            <span class="code-comment">//</span><span class="code-comment"> get sheet</span>
            sh = (XSSFSheet)wb.GetSheet(comboBox1.SelectedItem.ToString());

            <span class="code-keyword">int</span> i = <span class="code-digit">0</span>;
            <span class="code-keyword">while</span> (sh.GetRow(i) != <span class="code-keyword">null</span>)
            {
                <span class="code-comment">//</span><span class="code-comment"> add neccessary columns</span>
                <span class="code-keyword">if</span> (dataGridView1.Columns.Count <span class="code-keyword">&lt;</span> sh.GetRow(i).Cells.Count)
                {
                    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> sh.GetRow(i).Cells.Count; j++)
                    {
                        dataGridView1.Columns.Add(<span class="code-string">"</span><span class="code-string">"</span>, <span class="code-string">"</span><span class="code-string">"</span>);
                    }
                }
                
                <span class="code-comment">//</span><span class="code-comment"> add row</span>
                dataGridView1.Rows.Add();
                
                <span class="code-comment">//</span><span class="code-comment"> write row value</span>
                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> sh.GetRow(i).Cells.Count; j++)
                {
                    <span class="code-keyword">var</span> cell = sh.GetRow(i).GetCell(j);

                    <span class="code-keyword">if</span> (cell != <span class="code-keyword">null</span>)
                    {
                        <span class="code-comment">//</span><span class="code-comment"> TODO: you can add more cell types capability, e. g. formula</span>
                        <span class="code-keyword">switch</span> (cell.CellType)
                        {
                            <span class="code-keyword">case</span> NPOI.SS.UserModel.CellType.Numeric:
                                dataGridView1[j, i].Value = sh.GetRow(i).GetCell(j).NumericCellValue;
                                <span class="code-keyword">break</span>;
                            <span class="code-keyword">case</span> NPOI.SS.UserModel.CellType.<span class="code-sdkkeyword">String</span>:
                                dataGridView1[j, i].Value = sh.GetRow(i).GetCell(j).StringCellValue;
                                <span class="code-keyword">break</span>;
                        }
                    }
                }

                i++;
            }
        }

        <span class="code-keyword">private</span> <span class="code-keyword">void</span> button2_Click(<span class="code-keyword">object</span> sender, EventArgs e)
        {
            <span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> dataGridView1.RowCount - <span class="code-digit">1</span>; i++)
            {
                <span class="code-keyword">if</span> (sh.GetRow(i) == <span class="code-keyword">null</span>)
                    sh.CreateRow(i);

                <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> dataGridView1.ColumnCount; j++)
                {
                    <span class="code-keyword">if</span> (sh.GetRow(i).GetCell(j) == <span class="code-keyword">null</span>)
                        sh.GetRow(i).CreateCell(j);

                    <span class="code-keyword">if</span> (dataGridView1[j, i].Value != <span class="code-keyword">null</span>)
                    {
                        sh.GetRow(i).GetCell(j).SetCellValue(dataGridView1[j, i].Value.ToString());
                    }
                }
            }

            <span class="code-keyword">using</span> (<span class="code-keyword">var</span> fs = <span class="code-keyword">new</span> FileStream(<span class="code-string">"</span><span class="code-string">test.xlsx"</span>, FileMode.Open, FileAccess.Write))
            {
                wb.Write(fs);
            }
        }
    }
}</pre>

<h2>Post Scriptum</h2>

<p>I will structure this page content better, add examples of <strong>VB.NET and C++/CLI</strong> and add information and examples for <a href="http://www.codeproject.com/Articles/691749/Free-NET-Spreadsheet-Control">ReoGrid library</a> - it's a way to show Excel spreadsheets on form in the manner of Microsoft Excel.</p>

<p>But, a bit later.</p>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-loadonview="true" data-tags=".NET1.0, .NET1.1, .NET2.0, Win2K, WinXP, Win2003, Vista, C#2.0, .NET3.0, C#3.0, .NET3.5, VS2008, C#, Windows, .NET, Win32, Visual-Studio, DBA,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=300x250&amp;c=130105"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=300x250&amp;c=130105"  width="300px" height="250px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

<ul class="rrssb-buttons clearfix">
    
    <li id="ctl00_SocialLike_Twitter" class="twitter">
        <!-- Replace href with your Meta and URL information  -->
        <a href="http://twitter.com/home?status=C%23%3a+Read+and+Write+Excel+(*.xls+and+*.xlsx)+Files+Content+without+Excel+Automation+(using+NPOI+and+ADO.NET)+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                    c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                    C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                    C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                    c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                    C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                </svg>
            </span>
            <span class="text">twitter</span>
        </a>
    </li>

    <li id="ctl00_SocialLike_Facebook" class="facebook">
        <!-- Replace with your URL. For best results, make sure you page has the proper FB Open Graph tags in header: 
        https://developers.facebook.com/docs/opengraph/howtos/maximizing-distribution-media-content/ -->
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                        c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                        c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                </svg>
            </span>
            <span class="text">facebook</span>
        </a>
    </li>

    

    <li id="ctl00_SocialLike_LinkedIn" class="linkedin">
        <!-- Replace href with your meta and URL information -->
        <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con&amp;title=C%23%3a+Read+and+Write+Excel+(*.xls+and+*.xlsx)+Files+Content+without+Excel+Automation+(using+NPOI+and+ADO.NET)+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                        c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                        h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                        c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                        C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                </svg>
            </span>
            <span class="text">linkedin</span>
        </a>
    </li>
    <li id="ctl00_SocialLike_Reddit" class="reddit">
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con&amp;title=C%23%3a+Read+and+Write+Excel+(*.xls+and+*.xlsx)+Files+Content+without+Excel+Automation+(using+NPOI+and+ADO.NET)+-+CodeProject">
            <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
            </span>
            <span class="text">reddit</span>
        </a>
    </li>
    <li id="ctl00_SocialLike_GooglePlus" class="googleplus">
        <!-- Replace href with your meta and URL information.  -->
        <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.codeproject.com%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <g>
                        <g>
                            <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663
                                c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027
                                C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068
                                c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562
                                c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41
                                c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511
                                c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478
                                c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492
                                c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479
                                c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"></path>
                            <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004
                                23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89      "></polygon>
                        </g>
                    </g>
                </svg>
            </span>
            <span class="text">google+</span>
        </a>
    </li>

    

    

</ul>
<!-- Buttons end here -->

				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-loadonview="true" data-tags=".NET1.0, .NET1.1, .NET2.0, Win2K, WinXP, Win2003, Vista, C#2.0, .NET3.0, C#3.0, .NET3.5, VS2008, C#, Windows, .NET, Win32, Visual-Studio, DBA,rating4.5,pos_bottom"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=130105"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=728x90&amp;c=130105"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				</div>
				

                
        <h2 id="ctl00_AlsoRead_RelatedResults_ctl00_Header" class="also-read">You may also be interested in...</h2>
        <table class="spaced content-list also-read">
    
	    <tbody><tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl01_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl01_Thumbnail" href="https://www.codeproject.com/ResearchLibrary/262/A-Solution-Blueprint-for-DevOps"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/LibraryItemThumbnail_262_100x129.png" alt="" style="border-width:0px;"></a>
            <div class="pro-badge">Pro</div></div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl01_Link" href="https://www.codeproject.com/ResearchLibrary/262/A-Solution-Blueprint-for-DevOps">A Solution Blueprint for DevOps</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl02_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl02_Thumbnail" href="https://www.codeproject.com/ResearchLibrary/265/Using-PDFs-to-Manage-and-Share-Content"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/LibraryItemThumbnail_265_100x130.png" alt="" style="border-width:0px;"></a>
            <div class="pro-badge">Pro</div></div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl02_Link" href="https://www.codeproject.com/ResearchLibrary/265/Using-PDFs-to-Manage-and-Share-Content">Using PDFs to Manage and Share Content</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl03_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl03_Thumbnail" href="https://www.codeproject.com/Articles/8477/Using-ADO-NET-for-beginners"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/Thumb-8477.jpg" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl03_Link" href="https://www.codeproject.com/Articles/8477/Using-ADO-NET-for-beginners">Using ADO.NET for beginners</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl04_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl04_Thumbnail" href="https://www.codeproject.com/Articles/23/SAPrefs-Netscape-like-Preferences-Dialog"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/Thumb-23.gif" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl04_Link" href="https://www.codeproject.com/Articles/23/SAPrefs-Netscape-like-Preferences-Dialog">SAPrefs - Netscape-like Preferences Dialog</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl05_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl05_Thumbnail" href="https://www.codeproject.com/Articles/8500/Reading-and-Writing-Excel-using-OLEDB"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/Thumb-8500.JPG" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl05_Link" href="https://www.codeproject.com/Articles/8500/Reading-and-Writing-Excel-using-OLEDB">Reading and Writing Excel using OLEDB</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl06_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl06_Thumbnail" href="https://www.codeproject.com/Articles/107/Window-Tabs-WndTabs-Add-In-for-DevStudio"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/Thumb-107.jpg" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl06_Link" href="https://www.codeproject.com/Articles/107/Window-Tabs-WndTabs-Add-In-for-DevStudio">Window Tabs (WndTabs) Add-In for DevStudio</a></div>
                
            </div>
        </td>
	    </tr>
	
		</tbody></table>
	



				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumControl42077220.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con%3ffid%3d1867625%26df%3d90%26mpp%3d25%26prof%3dFalse%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="https://www.codeproject.com/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1867625"><input type="hidden" name="sbo" value="fm"><input id="search_forumControl42077220" type="search" class="search" name="qf"><input type="image" src="https://codeproject.global.ssl.fastly.net/images/search.gif">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="https://www.codeproject.com/script/Forums/SetOptions.aspx?fid=1867625&amp;df=90&amp;mpp=25&amp;prof=False&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;floc=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1867625"><input type="hidden" name="currentQS" value="fid=1867625&amp;df=90&amp;mpp=25&amp;prof=False&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;floc=%2fTips%2f813187%2fCsharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con"><input type="hidden" name="floc" value="/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Spacing<select size="1" class="dropdown" name="spc">
<option selected="" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option value="Normal">Normal</option><option value="Topic">Open Topics</option><option selected="" value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tbody><tr id="F5333496_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5333496xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container">It helps<div class="mobile-only">
	<span class="author">bendan01234</span><span class="date">30-Nov-16  20:03</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8740819">bendan01234</a></span></td><td class="date"><span>30-Nov-16  20:03&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8740819" msgid="5333496" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Excel file analysis worked.<br>
<br>
It would be better to abstract the excel column header as Grid Header. <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5333496" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5333496/It-helps.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5333496" data-ref="3_5333496" class="rating-label" name="RateItem_5333496" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5156748_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5156748xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Project demo is work fine, but my project is not working<div class="mobile-only">
	<span class="author">dangquang1020</span><span class="date">7-Nov-15  9:24</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7812637">dangquang1020</a></span></td><td class="date"><span>7-Nov-15  9:24&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7812637" msgid="5156748" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Your project demo is work fine, but when I run my project it thrown an error :<br>
<pre lang="text">Could not load file or assembly 'ICSharpCode.SharpZipLib, Version=0.86.0.518, Culture=neutral, PublicKeyToken=1b03e6acf1164f73' or one of its dependencies. The system cannot find the file specified.</pre><br>
I have tried some way follow the guide on internet but cannot resolve this issue.<br>
Can you help me to resolve this, thank you so much.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5156748" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5156748/Project-demo-is-work-fine-but-my-project-is-not-wo.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5156748" data-ref="3_5156748" class="rating-label" name="RateItem_5156748" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5120506_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5120506xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">help<div class="mobile-only">
	<span class="author">Member 11639067</span><span class="date">2-Sep-15  23:15</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11639067">Member 11639067</a></span></td><td class="date"><span>2-Sep-15  23:15&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="11639067" msgid="5120506" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">InternalWorkbook.CreateWorkbook() <br>
error:<br>
InternalWorkbook does not exist in the currrent context<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5120506" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/5120506/help.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF5120506" data-ref="3_5120506" class="rating-label" name="RateItem_5120506" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4974079_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4974079xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">to memory?<div class="mobile-only">
	<span class="author">calincoosmin</span><span class="date">5-Jan-15  21:38</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9552791">calincoosmin</a></span></td><td class="date"><span>5-Jan-15  21:38&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="9552791" msgid="4974079" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">There is any possibility to write to a stream in memory and not a filestream that require a "string path" ?<br>
Thanks<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4974079" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4974079/to-memory.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4974079" data-ref="3_4974079" class="rating-label" name="RateItem_4974079" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4974606_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4974606xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="4974606" parent="4974079" thread="4974079" href="https://www.codeproject.com/Messages/4974606/Re-to-memory.aspx">Re: to memory?</a><div class="mobile-only">
	<span class="author">Emiliarge</span><span class="date">6-Jan-15  9:50</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10727401">Emiliarge</a></span></td><td class="date"><span>6-Jan-15  9:50&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="10727401" msgid="4974606" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl42077220.SwitchMessage(null,4974079);" href="https://www.codeproject.com/Messages/4974079/to-memory.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I think yes:<br>
<pre>HSSFWorkbook.Write(Stream stream);</pre><br>
It's Stream, not FileStream specially.<br>
<br>
Also NPOI is open-source and you can fix any problem by yourself.<br>
Unfortunately, this is not true for all sources. For example, the source of Chromium weigh 2GB and it is unlikely that you can quickly fix them yourself <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)">  But NPOI like not such.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4974079" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4974606/Re-to-memory.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4974606" data-ref="3_4974606" class="rating-label" name="RateItem_4974606" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4974850_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx4974850xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4974850" parent="4974606" thread="4974079" href="https://www.codeproject.com/Messages/4974850/Re-to-memory.aspx">Re: to memory?</a><div class="mobile-only">
	<span class="author">calincoosmin</span><span class="date">6-Jan-15  21:23</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9552791">calincoosmin</a></span></td><td class="date"><span>6-Jan-15  21:23&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="9552791" msgid="4974850" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="56px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl42077220.SwitchMessage(null,4974606);" href="https://www.codeproject.com/Messages/4974606/Re-to-memory.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Yes you are right that it's a stream but if you want to write direct to a stream you will get an error of  "System.ObjectDisposedException". <br>
The problem is that I wanted to write to a stream and then to pass the stream to a request in order to upload the new excel to onedrive account. When I passed the stream I've got an error like "A closed stream cannot be accesed".<br>
<br>
So, I found a way to solve the "System.ObjectDisposedException" in this way:<br>
<br>
<pre lang="c#">XSSFWorkbook wb = <span class="code-keyword">new</span> XSSFWorkbook();
&nbsp;
<span class="code-comment">//</span><span class="code-comment"> create sheet</span>
XSSFSheet sh = (XSSFSheet)wb.CreateSheet(<span class="code-string">"</span><span class="code-string">Sheet1"</span>);
<span class="code-comment">//</span><span class="code-comment"> 10 rows, 10 columns</span>
<span class="code-keyword">for</span> (<span class="code-keyword">int</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> <span class="code-digit">100</span>; i++)
{
    <span class="code-keyword">var</span> r = sh.CreateRow(i);
    <span class="code-keyword">for</span> (<span class="code-keyword">int</span> j = <span class="code-digit">0</span>; j <span class="code-keyword">&lt;</span> <span class="code-digit">100</span>; j++)
    {
        r.CreateCell(j);
    }
}
&nbsp;
MemoryStream stream = <span class="code-keyword">new</span> MemoryStream();
wb.Write(stream);
stream.Dispose();
&nbsp;
<span class="code-keyword">var</span> arrBites = stream.ToArray();
&nbsp;
MemoryStream newStream = <span class="code-keyword">new</span> MemoryStream(arrBites);
&nbsp;
<span class="code-keyword">var</span> docFile = File(newStream, <span class="code-string">"</span><span class="code-string">application/octet-stream"</span>, <span class="code-string">"</span><span class="code-string">Excel.xlsx"</span>);
MemoryStream streamFile = <span class="code-keyword">new</span> MemoryStream();
docFile.FileStream.Position = <span class="code-digit">0</span>;
docFile.FileStream.CopyTo(streamFile);
&nbsp;
<span class="code-keyword">var</span> bites = streamFile.ToArray();
Stream stream2 = <span class="code-keyword">new</span> MemoryStream(bites);
&nbsp;
 LiveOperationResult getResult = <span class="code-keyword">await</span> connectedClient.UploadAsync(<span class="code-string">"</span><span class="code-string">me/skydrive"</span>, docFile.FileDownloadName, stream2, OverwriteOption.Overwrite);</pre><br>
<br>
First I write the excel to a stream, then I converte the stream to a byte array and then the byte array is converted again to a stream in order to get rid of the "System.ObjectDisposedException";<br>
The new stream is passed to a File and added the name and the content type. There are o lot of converts from stream to byte array and byte array to stream but this is what I found. I think there is a better solution and if I will found one I will post here.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4974079" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4974850/Re-to-memory.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4974850" data-ref="3_4974850" class="rating-label" name="RateItem_4974850" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4936102_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4936102xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Well done<div class="mobile-only">
	<span class="author">pkfox</span><span class="date">3-Nov-14  21:12</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3796335">pkfox</a></span></td><td class="date"><span>3-Nov-14  21:12&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3796335" msgid="4936102" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi and thanks for this information, I think an article dedicated to NPOI would be good the other ways work but are messy compared to NPOI and obviously have dependencies.<br>
<div class="signature">We can’t stop here, this is bat country - Hunter S Thompson RIP</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4936102" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4936102/Well-done.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4936102" data-ref="3_4936102" class="rating-label" name="RateItem_4936102" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4893272_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4893272xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container">My vote of 5<div class="mobile-only">
	<span class="author">skyformat99@gmail.com</span><span class="date">31-Aug-14  17:18</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4830928">skyformat99@gmail.com</a></span></td><td class="date"><span>31-Aug-14  17:18&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4830928" msgid="4893272" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">very good<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4893272" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4893272/My-vote-of.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4893272" data-ref="3_4893272" class="rating-label" name="RateItem_4893272" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4893263_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4893263xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">I don't like the namespace style.<div class="mobile-only">
	<span class="author">leiyangge</span><span class="date">31-Aug-14  16:17</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10049795">leiyangge</a></span></td><td class="date"><span>31-Aug-14  16:17&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10049795" msgid="4893263" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Any one agrees with me?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4893263" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4893263/I-dont-like-the-namespace-style.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4893263" data-ref="3_4893263" class="rating-label" name="RateItem_4893263" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4893265_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4893265xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="4893265" parent="4893263" thread="4893263" href="https://www.codeproject.com/Messages/4893265/Re-I-dont-like-the-namespace-style.aspx">Re: I don't like the namespace style.</a><div class="mobile-only">
	<span class="author">Emiliarge</span><span class="date">31-Aug-14  16:31</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10727401">Emiliarge</a></span></td><td class="date"><span>31-Aug-14  16:31&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="10727401" msgid="4893265" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl42077220.SwitchMessage(null,4893263);" href="https://www.codeproject.com/Messages/4893263/I-dont-like-the-namespace-style.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That's the namespace style?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4893263" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4893265/Re-I-dont-like-the-namespace-style.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4893265" data-ref="3_4893265" class="rating-label" name="RateItem_4893265" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4893009_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4893009xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">+5<div class="mobile-only">
	<span class="author">Member 455866</span><span class="date">30-Aug-14  23:58</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=455866">Member 455866</a></span></td><td class="date"><span>30-Aug-14  23:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="455866" msgid="4893009" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">+5
<div class="signature">Rand</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Sign In</a>·<wbr><a href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4893009" title="View Thread">View&nbsp;Thread</a></td><td style="text-align:right;"><a href="https://www.codeproject.com/Messages/4893009/plus.aspx" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0"></a>&nbsp;<span id="MVF4893009" data-ref="3_4893009" class="rating-label" name="RateItem_4893009" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  19:00 &nbsp; &nbsp; Last Update: 22-Dec-17  7:28</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=False&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?fid=1867625&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=False&amp;view=Normal&amp;fr=12"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p>
				

			</div>
			
		</td>
		<td width="170px" class="article-wing-right">
			<div id="ctl00_RightSideBar" class="container-article-info">

                <div id="RHSticky" class="container-article-info-sticky">
        			

<div class="article-summary">

    

    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top;width:160px;margin: 10px auto;">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-tags=".NET1.0, .NET1.1, .NET2.0, Win2K, WinXP, Win2003, Vista, C#2.0, .NET3.0, C#3.0, .NET3.5, VS2008, C#, Windows, .NET, Win32, Visual-Studio, DBA,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x200&amp;c=442389"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x200&amp;c=442389"  width="160px" height="200px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Enterprise-Systems/Office-Development/Microsoft-Excel" data-tags=".NET1.0, .NET1.1, .NET2.0, Win2K, WinXP, Win2003, Vista, C#2.0, .NET3.0, C#3.0, .NET3.5, VS2008, C#, Windows, .NET, Win32, Visual-Studio, DBA,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x600&amp;c=442389"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Enterprise-Systems/Office-Development/Microsoft-Excel&amp;sz=160x600&amp;c=442389"  width="160px" height="600px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				    </div>

                    

				    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con#_articleTop">Go to top</a>
                    </div>

				</div>

			</div>
		</td>
		</tr></tbody></table>

		
		<div class="theme1-background" style="height:2px" id="stickyStop"></div>

		<div class="extended tiny-text">
			<div class="row">
				<div class="float-left">
					<a id="ctl00_PermaLink" href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con">Permalink</a> | 
					<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a> |
					<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a> |
                    <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a> |
					<a id="ctl00_Mobile">Mobile</a>
					<br>
								
					
					Web04 |
					2.8.171207.1 |
					Last Updated 31 Aug 2014								
				</div>

                <div id="ctl00_GoogleTranslate" class="translate float-left"><div class="skiptranslate goog-te-gadget" dir="ltr" style=""><div id=":0.targetLanguage" class="goog-te-gadget-simple" style="white-space: nowrap;"><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/cleardot.gif" class="goog-te-gadget-icon" alt="" style="background-image: url(&quot;https://translate.googleapis.com/translate_static/img/te_ctrl3.gif&quot;); background-position: -65px 0px;"><span style="vertical-align: middle;"><a aria-haspopup="true" class="goog-te-menu-value" href="javascript:void(0)"><span>Select Language</span><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/cleardot.gif" alt="" width="1" height="1"><span style="border-left: 1px solid rgb(187, 187, 187);">​</span><img src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/cleardot.gif" alt="" width="1" height="1"><span aria-hidden="true" style="color: rgb(118, 118, 118);">▼</span></a></span></div></div></div>      

				<div class="float-right align-right">
					Article Copyright 2014 by Emiliarge<br>Everything else
					Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2017 <br>
				</div>

				


<div class="page-width">
Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?PageFlow=FixedWidth">fixed</a>
|
<a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Tips/813187/Csharp-Read-and-Write-Excel-xls-and-xlsx-Files-Con?PageFlow=Fluid">fluid</a>
</div>



			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div>
</div>


<img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord=&#39;636495424829889353&#39;;dc_seg=33704410?" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript" language="Javascript" src="https://codeproject.global.ssl.fastly.net/script/Articles/JS/article.min.js?dt=2.8.171207.1"></script>
<script type="text/javascript" language="Javascript" src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/element.js.download"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
$(document).ready(function () { processCodeBlocks.Initialise('#contentdiv'); });
function googleTranslateElementInit() {  new google.translate.TranslateElement({   pageLanguage: 'en',   layout: google.translate.TranslateElement.InlineLayout.SIMPLE,   autoDisplay: false,   gaTrack: true,   gaId: 'UA-1735123-1'},  'ctl00_GoogleTranslate');}
$(document).ready(function() { anchorAnimate();
$('#RHSticky').sticky($('#stickyStop'));
$('#ctl00_Nav').sticky($('#stickyStop'));
});
$(function ()
                {
                    $('.oauth').click(function () {
                        $this = $(this);
                        href = $this.attr('href');
                        var myWindow = window.open(href, 'popup',
                                    'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
                        myWindow.focus();
                        var timer = setInterval(function () {
                                        if (myWindow.closed) {
                                            clearInterval(timer);
                                            // window.location.reload(); // May do a POST reload, shows a warning
                                            window.location = window.location; // force a GET reload
                                        }
                                    }, 200);
                        return false;
                    });
                });
var retrievalService=function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).bind("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};$(document).ready(function(){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new retrievalService).init()}catch(i){(new retrievalService).init()}};try{t=('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn2.developermedia.com/a.min.js';n.open("GET",t,!0);n.send()}catch(i){(new retrievalService).init()}});
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 if(InitWatermark)InitWatermark('sb_tb', 'Search for articles, questions, tips');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
  sbar.blur(function() {
 if (!oSrchFlt) {sfilter.hide(); sfilter.removeClass('open');}
 srchBoxFoc=false;
 });
  sbar.focus(function() {
 oSrchFlt=false; srchBoxFoc=true;
 sfilter.show(); sfilter.addClass('open');
 });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});

$(function() {
   var bookmark = new Bookmark('[data-type="bookmark"]','https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/','/script/Bookmarks/Ajax/Add.aspx?obrfgd=%5bObjectRefGuid%5d&bis=medium',false);
   bookmark.Initialise();
});
$('#clear-rate_ctl00_RateArticle_RSU').click(function () {    $('#ctl00_RateArticle_RSU').hide(); return false;});$("#ctl00_RateArticle_RateItemWrapper")   .removeClass("container-rating")   .hover( function() { $('#ctl00_RateArticle_RSU').fadeIn('fast'); },            function() { $('#ctl00_RateArticle_RSU').fadeOut('fast'); } );
function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 813187,2,6,true,true,0,'MediumStars', null, ratingAjaxCallback);
}

                        function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                            if (!$('#' + containerId).attr('alreadyRequested')){
                                $.ajax({
                                    url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId,
                                    success: function (data) {
                                        $('#' + containerId).html(data);
                                        $('#' + loadingId).hide();
                                    }
                                });
                                $('#' + containerId).attr('alreadyRequested', 'true');
                            }
                        }
$(document).ready(function() {
  new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
  $('#ctl00_RateArticle_RB').mouseenter(function() {     getVotesHistogram(813187,2   ,'ctl00_RateArticle_Histogram','ctl00_RateArticle_Loading');
  });
})

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(){}

var config42077220 = {
    objectName          : 'forumControl42077220',
    messageTypeId       : 3,
    searchPrompt        : 'Search Comments',
    smoothScroll        : true,
    allowReporting      : false,
    allowRating         : false,
    allowRatingDisplay  : true,
    forumDir            : '/script/Forums/',
    staticServer        : 'https://codeproject.global.ssl.fastly.net',
    switchMsgCallback   : null,
    getVoteFormMethod   : getVoteFormHtml,
    getReportFormMethod : getReportFormHtml,
    voteHiThreshold     : 5 - 0.5,
    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
    getRatingRefKey     : 'obrs',
    reportOptions       : [
       { reportTypeId : 19, name : 'Abusive / Trolling'},
       { reportTypeId : 20, name : 'Inappropriate'},
       { reportTypeId : 5, name : 'Spam'},
    ],
};
var forumControl42077220 = new ForumControl(config42077220, -1);
$(document).ready(function() {
    forumControl42077220.Initialise();
});


//]]>
</script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>



<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 1030px; height: 263px; display: none;" src="./C#_ Read and Write Excel (_.xls and _.xlsx) Files Content without Excel Automation (using NPOI and ADO.NET) - CodeProject_files/saved_resource.html"></iframe></body></html>